<!DOCTYPE html>
<!-- saved from url=(0077)https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_1 -->
<html lang="zh-cn"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="origin">
    <meta property="og:description" content="innodb事务日志包括redo log和undo log。redo log是重做日志，提供前滚操作，undo log是回滚日志，提供回滚操作。 undo log不是redo log的逆向过程，其实它">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>详细分析MySQL事务日志(redo log和undo log) - 骏马金龙 - 博客园</title>
    
    <link rel="stylesheet" href="./详细分析MySQL事务日志(redo log和undo log)_files/blog-common.min.css">
    
    <link type="text/css" rel="stylesheet" href="./详细分析MySQL事务日志(redo log和undo log)_files/custom.css">
    <link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="./详细分析MySQL事务日志(redo log和undo log)_files/bundle-lessismore-mobile.min.css">
    
    <link type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/f-ck-need-u/rss">
    <link type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/f-ck-need-u/rsd.xml">
    <link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/f-ck-need-u/wlwmanifest.xml">
    <script async="" src="./详细分析MySQL事务日志(redo log和undo log)_files/analytics.js.下载"></script><script type="text/javascript" src="./详细分析MySQL事务日志(redo log和undo log)_files/encoder.js.下载"></script><script src="./详细分析MySQL事务日志(redo log和undo log)_files/jquery-2.2.0.min.js.下载"></script>
    <script src="./详细分析MySQL事务日志(redo log和undo log)_files/blog-common.min.js.下载"></script>
    <script>
        var currentBlogId = 222371;
        var currentBlogApp = 'f-ck-need-u';
        var cb_enable_mathjax = false;
        var isLogined = false;
        var skinName = 'LessIsMore';
    </script>
    
    
    
<link rel="shortcut icon" href="https://files.cnblogs.com/files/f-ck-need-u/favicon.ico"><script charset="utf-8" src="chrome-extension://jgphnjokjhjlcnnajmfjlacjnjkhleah/js/btype.js"></script><script type="text/javascript" charset="utf-8" src="chrome-extension://jgphnjokjhjlcnnajmfjlacjnjkhleah/js/chrome.js"></script><link rel="preload" href="./详细分析MySQL事务日志(redo log和undo log)_files/f.txt" as="script"><script type="text/javascript" src="./详细分析MySQL事务日志(redo log和undo log)_files/f.txt"></script><script src="./详细分析MySQL事务日志(redo log和undo log)_files/pubads_impl_2020040201.js.下载" async=""></script><style type="text/css">.tctip{position:fixed;right:0;z-index:10000;padding-left:34px;width:0;overflow:hidden;box-sizing:content-box;background-color:transparent}.tctip li,.tctip ul{margin:0;padding:0}.tctip img{border:0;display:block}.tctip a{color:#000;text-decoration:none;outline:0 none}.tctip .tctip-btn-box{position:absolute;left:0;top:50%;margin-top:-46px;width:34px;height:93px}.tctip .tctip-main-box{width:240px;height:332px;font:12px/1.5 microsoft yahei,tahoma,arial,sans-serif;color:#000;background-color:#fff;border:1px solid #dbdbdb;border-right:none}.tctip .tctip-main-box .tctip-footer,.tctip .tctip-main-box .tctip-title{margin:0;height:26px;line-height:26px;background-color:#e7e7e7}.tctip .tctip-main-box .tctip-title{padding:0 0 0 6px;font-size:14px;font-weight:400;background-image:none}.tctip .tctip-main-box .tctip-footer{padding-right:6px;font-size:12px;text-align:right}.tctip .tctip-main-box .tctip-footer a:hover{text-decoration:underline}.tctip .tctip-main-box .tctip-body-box{font-size:0;background-color:#eee;width:240px}.tctip .tctip-main-box .tctip-body-box .tctip-icon-box{display:inline-block;vertical-align:middle;width:90px;font-size:12px}.tctip .tctip-main-box .tctip-body-box .tctip-icon-box ul{list-style:none}.tctip .tctip-main-box .tctip-body-box .tctip-icon-box ul a.fifth{border-bottom:none}.tctip .tctip-main-box .tctip-body-box .tctip-icon-box ul.not-full{border-top:1px solid #dfdfdf}.tctip .tctip-main-box .tctip-body-box .tctip-icon-box ul li{display:block;height:56px;transition:background-color .2s linear}.tctip .tctip-main-box .tctip-body-box .tctip-icon-box ul li.tctip-current{border-right:none}.tctip .tctip-main-box .tctip-body-box .tctip-icon-box ul li.tctip-current a,.tctip .tctip-main-box .tctip-body-box .tctip-icon-box ul li.tctip-current a:hover{background-color:#fff}.tctip .tctip-main-box .tctip-body-box .tctip-icon-box ul li a{position:relative;display:block;padding-left:40px;height:55px;line-height:55px;font-size:12px;border-bottom:1px solid #ccc}.tctip .tctip-main-box .tctip-body-box .tctip-icon-box ul li a img{position:absolute;left:6px;top:13px;width:30px;height:30px}.tctip .tctip-main-box .tctip-body-box .tctip-qr-detail{display:inline-block;vertical-align:middle;width:150px;height:280px;font-size:12px;background-color:#fff}.tctip .tctip-main-box .tctip-body-box .tctip-qr-detail .tctip-qr-box{padding:14px 0 0 10px}.tctip .tctip-main-box .tctip-body-box .tctip-qr-detail .tctip-qr-box .tctip-qr-title{margin:0 0 20px;width:132px;height:30px;line-height:30px;font-size:12px;text-align:center}.tctip .tctip-main-box .tctip-body-box .tctip-qr-detail .tctip-qr-box .tctip-qr-code{margin:0 0 20px;padding:12px;width:106px;height:106px;background:url(data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QNvaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjMtYzAxMSA2Ni4xNDU2NjEsIDIwMTIvMDIvMDYtMTQ6NTY6MjcgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6QjgxOTIzMjRGMjhCRTQxMTk5QjZGNERBNDI5NUVBNjEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjkxODAwMUY4Q0Y4MTFFNEE0NkVCQUVGNjA3MDhFMzUiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjkxODAwMUU4Q0Y4MTFFNEE0NkVCQUVGNjA3MDhFMzUiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBNzMwMTIzMEZBOEJFNDExOTlCNkY0REE0Mjk1RUE2MSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCODE5MjMyNEYyOEJFNDExOTlCNkY0REE0Mjk1RUE2MSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pv/uAA5BZG9iZQBkwAAAAAH/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgMDAwMDAwMDAwMBAQEBAQEBAgEBAgICAQICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA//AABEIAIIAggMBEQACEQEDEQH/xAB+AAEAAwEBAQEAAAAAAAAAAAAABgcIBQMECgEBAAAAAAAAAAAAAAAAAAAAABAAAQIEAAoGBgcJAQAAAAAAAAIDAQQFBhHUlbUWNlZ2mNgxYRITMzUhUVODFDRBIjJSYmNlcYEjcyRUdRc4SBEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8A/eRLy6rpi7PTzr8KHB99im01h52Xan2pd1bC6lUlsqbdmW5l1tUWWYq7mDPZUpKlK+oH26HWl9Nr27HrVRaapUeuKlS0VRj+0BodaOy1uZEpmKgNDrR2WtzIlMxUBodaOy1uZEpmKgNDrR2WtzIlMxUBodaOy1uZEpmKgNDrR2WtzIlMxUBodaOy1uZEpmKgNDrR2WtzIlMxUBodaOy1uZEpmKgNDrR2WtzIlMxUBodaOy1uZEpmKgNDrR2WtzIlMxUBodaOy1uZEpmKgeL1uNSCVTVswRSJ1qEVok2Yqao0/wBmGH4Wdp6P6ZpL3RB5pCHm4xwwjGGFKg5n+wKZ/azflHx3QnzPZ7/K9X2OsDs2dqla8fXbtFVHrUqmyylRj1xVHCBIwAAAAAAAAAAAAAAAADOeCHq/9D9x7n2X8vq6ALps7VG1t3KJmyVAkYAAAAAAAAAAAAAAAABnPmMAumztUbW3combJUCRgAAAAAAAAAAAAAAAAGc+YwC6bO1RtbdyiZslQJGAAAAAAAAAAAAAAAAAZz5jALps7VG1t3KJmyVAkYAAAAAAAAAAAAAAAABnPmMAumztUbW3combJUCRgAAAABznaRSX5pE8/S6c9OtqQtucdkpZyaQtpSFtqRMLai8lTa20xTGEcMIphGHRADogAAAAAAAAAGc+YwC6bO1RtbdyiZslQJGAAAAAAAAAAAAAAAAAZz5jALps7VG1t3KJmyVAkYAAAAAAAAAAAAAAAABnPmMAumztUbW3combJUCRgAAAAAAAAAAAAAAAAGc+YwC6bO1RtbdyiZslQJGAAAAAAAAAAAAAAAAAZz5jALps7VG1t3KJmyVAkYAAAAAAAAAAAAAAAABnPmMAumztUbW3combJUCRgAAAAB4PTDcv3XbS+rvXm2EdzLTEzgW6qCUqd+Had7lmEY/WcX2W0Q9KlQh6QPcAAAAAAAAAAznzGAXTZ2qNrbuUTNkqBIwAAAAAAAAAAAAAAAADOfMYBdNnao2tu5RM2SoEjAAAAAAAAAAAAAAAAAM58xgFxW2+iQaTbM0qDU7SUKZk21xgn46jNLiinzsrhwd8luV7Db0E4YtvJjCPoimKglQAAAAAAAAAAAAAAADm1Sqy1Jlu/fipbriu6k5NrAqbn5tUP4UpKNYcLr7qv3JhhUqMEwjGAVjoNW/ayvj6Y+JHXn2PR5d+Z0/hAkt/eVy3lPzUPnvMvsR1f/Vfu/hwgVdDoh/0P7jwfdfl+rqAcRgDiMAcRgDiMAcRgDiMAcRgDiMAcRgDiMAcRgDiMAcRgEssbzl3xvlV64a8/R4P6b9/rwAXAB//2Q==) no-repeat;box-sizing:content-box}.tctip .tctip-main-box .tctip-body-box .tctip-qr-detail .tctip-qr-box .tctip-qr-code img{width:106px;height:106px}.tctip .tctip-main-box .tctip-body-box .tctip-qr-detail .tctip-qr-box .tctip-qr-desc{font-size:12px;word-break:break-all;text-align:center}</style><link rel="prefetch" href="https://tpc.googlesyndication.com/safeframe/1-0-37/html/container.html"></head>
<body style="padding-left: 180px;">
    <a name="top"></a>
    <div id="page_begin_html">
        <link href="./详细分析MySQL事务日志(redo log和undo log)_files/font-awesome.min.css" rel="stylesheet">
<link href="./详细分析MySQL事务日志(redo log和undo log)_files/lnh.cnblogs2.css" rel="stylesheet">

    <div id="home">
        <div id="header1">
            <div id="blogTitle1">
                <span style="font-size: 24px;"><strong><a href="http://www.cnblogs.com/f-ck-need-u/">骏马金龙</a></strong></span>
                <p>网名骏马金龙，钟情于IT世界里的各种原理和实现机制，强迫症重症患者。爱研究、爱翻译、爱分享。特借此一亩三分田记录自己成长点滴！！！<br>
                <font color="#8484fd">我本问道人，道心不坚，必将与道无缘！</font>
                </p>
            </div>
            <div id="navigator">
                <ul id="navList1">
                    <!-- <li><a id="blog_nav_sitehome" class="menu" href="http://www.cnblogs.com/">博客园</a></li> -->
                    <!-- <li><a id="blog_nav_myhome" class="menu" href="http://www.cnblogs.com/f-ck-need-u/">首页</a></li> -->
                    <!-- <li><a id="blog_nav_newpost" class="menu" rel="nofollow" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">新随笔</a></li> -->
                    <li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://i.cnblogs.com/">管理</a></li>
                    <li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://www.cnblogs.com/f-ck-need-u/p/11785409.html">视频教程</a></li>
                    <li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://www.cnblogs.com/f-ck-need-u/p/7048359.html/">Linux &amp; Shell</a></li>
                    <li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://www.cnblogs.com/f-ck-need-u/p/7586194.html/">MySQL</a></li>
                    <li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://www.cnblogs.com/f-ck-need-u/p/7576137.html/">网站架构</a></li>
                    <li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://www.cnblogs.com/f-ck-need-u/p/9512185.html">Perl</a></li>
                    <li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://www.cnblogs.com/f-ck-need-u/p/9832640.html">Python</a></li>
                    <li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://www.cnblogs.com/f-ck-need-u/p/9832538.html">Golang</a></li>

                    <li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://www.cnblogs.com/f-ck-need-u/p/10805545.html">Ruby</a></li>

                    <li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://www.cnblogs.com/f-ck-need-u/p/10481466.html">操作系统</a></li>
                    <li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://www.cnblogs.com/f-ck-need-u/p/8675736.html">Win调整</a></li>
                </ul>
            </div>
        </div>
    </div>
<!--
<script>
// 链接总在新标签内打开
$(document).click(function(e){
    var alink = $(e.target).closest('a')
    if(alink && alink.attr('target') !== "_blank"){
        alink.attr('target','_blank')
    }
})
</script>
-->


<!--
<script>
  function warnMsg(x, y) {
    var msg = document.getElementById("showMsg")
    if (!msg) {
      var showdiv = document.createElement("div")
      showdiv.id = "showMsg"
      showdiv.style.backgroundColor = "skyblue"
      showdiv.style.borderStyle = "solid"
      showdiv.style.position = "fixed"
      showdiv.style.display = "block"
      showdiv.style.left = x + "px"
      showdiv.style.top = y + "px"

      var txtContent = document.createTextNode("不能复制、不能右键")
      showdiv.style.fontSize = "20px"
      showdiv.style.color = "red"

      showdiv.appendChild(txtContent)
      document.body.appendChild(showdiv)

      msg = document.getElementById("showMsg")
      setTimeout(function () {
        msg.style.display = "none"
      }, 500)
      return
    }

    if (msg.style.display !== "none") {
      msg.style.display = "none"
    } else {
      msg.style.left = x + "px"
      msg.style.top = y + "px"
      msg.style.display = "block"
      setTimeout(function () {
        msg.style.display = "none"
      }, 500)
    }
  }
  // 禁用剪切
  setTimeout(function () {
    var postname = document.getElementById("cnblogs_post_body")
    postname.oncut = function (event) {
      event.preventDefault()
      warnMsg(event.clientX, event.clientY)
    }
    // 禁用复制
    postname.oncopy = function (event) {
      event.preventDefault()
      warnMsg(event.clientX, event.clientY)
    }
    // 禁用右键菜单
    postname.oncontextmenu = function (event) {
      if (event.target.tagName !== "A" && event.target.parentNode.tagName !== "A") {
        event.preventDefault()
        warnMsg(event.clientX, event.clientY)
      }
    }
  }, 1000)
</script>
-->
    </div>
    <div id="home">
    <div id="header">
        <div id="blogTitle">
            
<div class="title"><a id="Header1_HeaderTitle" class="headermaintitle HeaderMainTitle" href="https://www.cnblogs.com/f-ck-need-u/">骏马金龙</a>
</div>
<div class="subtitle">
网名骏马金龙，钟情于IT世界里的各种原理和实现机制，强迫症重症患者。爱研究、爱翻译、爱分享。特借此一亩三分田记录自己成长点滴！！！
</div>

        </div>
        <div id="navigator">
            
<ul id="navList">
    <li id="nav_sitehome">
</li>
    <li id="nav_myhome">
<a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/f-ck-need-u/">
首页</a>
</li>
    <li id="nav_newpost">


</li>
    <li id="nav_contact">
</li>
    <li id="nav_rss">
</li>
    <li id="nav_admin">
<a id="blog_nav_admin" class="menu" href="https://i.cnblogs.com/">
管理</a>
</li>
</ul>

            <div class="blogStats">
                
<span id="stats_post_count">随笔 - 
536&nbsp;</span>
<span id="stats_article_count">文章 - 
1&nbsp;</span>
<!-- <span id="stats-comment_count"></span> -->
<span id="stats_comment_count">评论 - 
1019</span>
            </div>
        </div>
    </div>
    <div id="main">
        <div id="mainContent">
            <div class="forFlow">
                <div id="post_detail">
    <div id="topics">
        <div class="post">
            <h1 class="postTitle">
                
<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/f-ck-need-u/p/9010872.html">详细分析MySQL事务日志(redo log和undo log)</a>

            </h1>
            <div class="clear"></div>
            <div class="post-categoty-tags"><div class="post-categoty">
    分类: 
            <a href="https://www.cnblogs.com/f-ck-need-u/category/1085743.html" target="_blank">数据库系列</a></div><div class="post-tags">undefined</div></div><div class="postBody">
                
<div id="cnblogs_post_body" class="blogpost-body ">
    <p>innodb事务日志包括redo log和undo log。redo log是重做日志，提供前滚操作，undo log是回滚日志，提供回滚操作。</p>
<p class="01">undo log不是redo log的逆向过程，其实它们都算是用来恢复的日志：<br>
<span style="color: #ff0000;"><strong>1.redo log通常是物理日志，记录的是数据页的物理修改，而不是某一行或某几行修改成怎样怎样，它用来恢复提交后的物理数据页(恢复数据页，且只能恢复到最后一次提交的位置)。</strong></span><br><span style="color: #ff0000;"><strong>
2.undo用来回滚行记录到某个版本。undo log一般是逻辑日志，根据每行记录进行记录。</strong></span></p>
<p class="01"><a name="blog1"></a></p>
<h1 class="01" id="auto_id_0">1.redo log</h1>
<p><a name="blog1.1"></a></p>
<h2 class="01" id="auto_id_1">1.1 redo log和二进制日志的区别</h2>
<p class="01">二进制日志相关内容，参考：<span style="color: #0000ff;"><a href="http://www.cnblogs.com/f-ck-need-u/p/9001061.html#blog5" target="_blank"><span style="color: #0000ff;">MariaDB/MySQL的二进制日志</span></a></span>。</p>
<p class="01">redo log不是二进制日志。虽然二进制日志中也记录了innodb表的很多操作，<strong><span style="color: #ff0000;">也能实现重做的功能</span>，</strong>但是它们之间有很大区别。</p>
<ol>
<li class="01">二进制日志是在<span style="color: #ff0000;"><strong>存储引擎的上层</strong></span>产生的，不管是什么存储引擎，对数据库进行了修改都会产生二进制日志。而redo log是innodb层产生的，只记录该存储引擎中表的修改。<span style="color: #ff0000;"><strong>并且二进制日志先于</strong><strong>redo log</strong><strong>被记录</strong></span>。具体的见后文group commit小结。</li>
<li class="01">二进制日志记录操作的方法是逻辑性的语句。即便它是基于行格式的记录方式，其本质也还是逻辑的SQL设置，如该行记录的每列的值是多少。而redo log是在物理格式上的日志，它记录的是数据库中每个页的修改。</li>
<li class="01">二进制日志只在每次事务提交的时候一次性写入缓存中的日志"文件"(对于非事务表的操作，则是每次执行语句成功后就直接写入)。而redo log在数据准备修改前写入缓存中的redo log中，然后才对缓存中的数据执行修改操作；而且保证在发出事务提交指令时，先向缓存中的redo log写入日志，写入完成后才执行提交动作。</li>
<li class="01">因为二进制日志只在提交的时候一次性写入，所以二进制日志中的记录方式和提交顺序有关，且一次提交对应一次记录。而redo log中是记录的物理页的修改，redo log文件中同一个事务可能多次记录，最后一个提交的事务记录会覆盖所有未提交的事务记录。例如事务T1，可能在redo log中记录了&nbsp;<span class="cnblogs_code">T1-<span style="color: #800080;">1</span>,T1-<span style="color: #800080;">2</span>,T1-<span style="color: #800080;">3</span>，T1*</span>&nbsp;共4个操作，其中&nbsp;<span class="cnblogs_code">T1*</span>&nbsp;表示最后提交时的日志记录，所以对应的数据页最终状态是&nbsp;<span class="cnblogs_code">T1*</span>&nbsp;对应的操作结果。而且redo log是并发写入的，不同事务之间的不同版本的记录会穿插写入到redo log文件中，例如可能redo log的记录方式如下：&nbsp;<span class="cnblogs_code">T1-<span style="color: #800080;">1</span>,T1-<span style="color: #800080;">2</span>,T2-<span style="color: #800080;">1</span>,T2-<span style="color: #800080;">2</span>,T2*,T1-<span style="color: #800080;">3</span>,T1*</span>&nbsp;。</li>
<li class="01">事务日志记录的是物理页的情况，它具有幂等性，因此记录日志的方式极其简练。幂等性的意思是多次操作前后状态是一样的，例如新插入一行后又删除该行，前后状态没有变化。而二进制日志记录的是所有影响数据的操作，记录的内容较多。例如插入一行记录一次，删除该行又记录一次。</li>

























</ol>
<p class="01"><a name="blog1.2"></a></p>
<h2 class="01" id="auto_id_2">1.2 redo log的基本概念</h2>
<p class="01">redo log包括两部分：一是内存中的日志缓冲(redo log buffer)，该部分日志是易失性的；二是磁盘上的重做日志文件(redo log file)，该部分日志是持久的。</p>
<p class="01">在概念上，innodb通过<span style="color: #ff0000;"><strong><em>force log at commit</em></strong></span>机制实现事务的持久性，即在事务提交的时候，必须先将该事务的所有事务日志写入到磁盘上的redo log file和undo log file中进行持久化。</p>
<p class="01">为了确保每次日志都能写入到事务日志文件中，在每次将log buffer中的日志写入日志文件的过程中都会调用一次操作系统的fsync操作(即fsync()系统调用)。因为MariaDB/MySQL是工作在用户空间的，MariaDB/MySQL的log buffer处于用户空间的内存中。要写入到磁盘上的log file中(redo:ib_logfileN文件,undo:share tablespace或.ibd文件)，中间还要经过操作系统内核空间的os buffer，调用fsync()的作用就是将OS buffer中的日志刷到磁盘上的log file中。</p>
<p class="01">也就是说，从redo log buffer写日志到磁盘的redo log file中，过程如下：&nbsp;</p>
<p class="01"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/733013-20180508101949424-938931340.png" alt=""></p>
<blockquote>
<p class="a">在此处需要注意一点，一般所说的log file并不是磁盘上的物理日志文件，而是操作系统缓存中的log file，官方手册上的意思也是如此(例如：With a value of 2, the contents of the <span style="color: #ff0000;"><strong>InnoDB log buffer are written to the log file</strong></span> after each transaction commit and <span style="color: #ff0000;"><strong>the log file is flushed to disk approximately once per second</strong></span>)。但说实话，这不太好理解，既然都称为file了，应该已经属于物理文件了。所以在本文后续内容中都以os buffer或者file system buffer来表示官方手册中所说的Log file，然后log file则表示磁盘上的物理日志文件，即log file on disk。</p>
<p class="a">另外，之所以要经过一层os buffer，是因为open日志文件的时候，open没有使用O_DIRECT标志位，该标志位意味着绕过操作系统层的os buffer，IO直写到底层存储设备。不使用该标志位意味着将日志进行缓冲，缓冲到了一定容量，或者显式fsync()才会将缓冲中的刷到存储设备。使用该标志位意味着每次都要发起系统调用。比如写abcde，不使用o_direct将只发起一次系统调用，使用o_object将发起5次系统调用。</p>























</blockquote>
<p class="01">MySQL支持用户自定义在commit时如何将log buffer中的日志刷log file中。这种控制通过变量&nbsp;<span class="cnblogs_code">innodb_flush_log_at_trx_commit</span>&nbsp;的值来决定。该变量有3种值：0、1、2，默认为1。但注意，这个变量只是控制commit动作是否刷新log buffer到磁盘。</p>
<ul>
<li class="a">当设置为1的时候，事务每次提交都会将log buffer中的日志写入os buffer并调用fsync()刷到log file on disk中。这种方式即使系统崩溃也不会丢失任何数据，但是因为每次提交都写入磁盘，IO的性能较差。</li>
<li class="a">当设置为0的时候，事务提交时不会将log buffer中日志写入到os buffer，而是每秒写入os buffer并调用fsync()写入到log file on disk中。也就是说设置为0时是(大约)每秒刷新写入到磁盘中的，当系统崩溃，会丢失1秒钟的数据。</li>
<li class="a">当设置为2的时候，每次提交都仅写入到os buffer，然后是每秒调用fsync()将os buffer中的日志写入到log file on disk。</li>























</ul>
<p class="01"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/733013-20180508104623183-690986409.png" alt=""></p>
<p class="01">注意，有一个变量&nbsp;<span class="cnblogs_code">innodb_flush_log_at_timeout</span>&nbsp;的值为1秒，该变量表示的是刷日志的频率，很多人误以为是控制&nbsp;<span class="cnblogs_code">innodb_flush_log_at_trx_commit</span>&nbsp;值为0和2时的1秒频率，实际上并非如此。测试时将频率设置为5和设置为1，当&nbsp;<span class="cnblogs_code">innodb_flush_log_at_trx_commit</span>&nbsp;设置为0和2的时候性能基本都是不变的。关于这个频率是控制什么的，在后面的"<a href="file:///E:/onedrive/%E6%88%91%E7%9A%84%E5%AD%A6%E4%B9%A0/MySQL/MySQL%E7%AE%A1%E7%90%86%E7%AF%87/MySQL%E7%AE%A1%E7%90%86.docx#_%E5%88%B7%E6%97%A5%E5%BF%97%E5%88%B0%E7%A3%81%E7%9B%98%E7%9A%84%E8%A7%84%E5%88%99">刷日志到磁盘的规则</a>"中会说。</p>
<p class="01">在主从复制结构中，要保证事务的持久性和一致性，需要对日志相关变量设置为如下：</p>
<ul>
<li><span style="color: #ff0000;"><strong>如果启用了二进制日志，则设置sync_binlog=1，即每提交一次事务同步写到磁盘中。</strong></span></li>
<li><span style="color: #ff0000;"><strong>总是设置innodb_flush_log_at_trx_commit=1，即每提交一次事务都写到磁盘中。</strong></span></li>























</ul>
<p class="01">上述两项变量的设置保证了：每次提交事务都写入二进制日志和事务日志，并在提交时将它们刷新到磁盘中。</p>
<p class="01">选择刷日志的时间会严重影响数据修改时的性能，特别是刷到磁盘的过程。下例就测试了&nbsp;<span class="cnblogs_code">innodb_flush_log_at_trx_commit</span>&nbsp;分别为0、1、2时的差距。</p>
<div>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #000000;">#创建测试表
</span><span style="color: #0000ff;">drop</span> <span style="color: #0000ff;">table</span> <span style="color: #0000ff;">if</span> <span style="color: #808080;">exists</span><span style="color: #000000;"> test_flush_log;
</span><span style="color: #0000ff;">create</span> <span style="color: #0000ff;">table</span> test_flush_log(id <span style="color: #0000ff;">int</span>,name <span style="color: #0000ff;">char</span>(<span style="color: #800000; font-weight: bold;">50</span>))engine<span style="color: #808080;">=</span><span style="color: #000000;">innodb;

#创建插入指定行数的记录到测试表中的存储过程
</span><span style="color: #0000ff;">drop</span> <span style="color: #0000ff;">procedure</span> <span style="color: #0000ff;">if</span> <span style="color: #808080;">exists</span> <span style="color: #0000ff;">proc</span><span style="color: #000000;">;
delimiter $$
</span><span style="color: #0000ff;">create</span> <span style="color: #0000ff;">procedure</span> <span style="color: #0000ff;">proc</span>(i <span style="color: #0000ff;">int</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">begin</span>
    <span style="color: #0000ff;">declare</span> s <span style="color: #0000ff;">int</span> <span style="color: #0000ff;">default</span> <span style="color: #800000; font-weight: bold;">1</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">declare</span> c <span style="color: #0000ff;">char</span>(<span style="color: #800000; font-weight: bold;">50</span>) <span style="color: #0000ff;">default</span> repeat(<span style="color: #ff0000;">'</span><span style="color: #ff0000;">a</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">50</span><span style="color: #000000;">);
    </span><span style="color: #0000ff;">while</span> s<span style="color: #808080;">&lt;=</span><span style="color: #000000;">i do
        start </span><span style="color: #0000ff;">transaction</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">insert</span> <span style="color: #0000ff;">into</span> test_flush_log <span style="color: #0000ff;">values</span>(<span style="color: #0000ff;">null</span><span style="color: #000000;">,c);
        </span><span style="color: #0000ff;">commit</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">set</span> s<span style="color: #808080;">=</span>s<span style="color: #808080;">+</span><span style="color: #800000; font-weight: bold;">1</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">end</span> <span style="color: #0000ff;">while</span><span style="color: #000000;">;
</span><span style="color: #0000ff;">end</span><span style="color: #000000;">$$
delimiter ;</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/copycode.gif" alt="复制代码"></a></span></div></div>
</div>
<p class="01">当前环境下，&nbsp;<span class="cnblogs_code">innodb_flush_log_at_trx_commit</span>&nbsp;的值为1，即每次提交都刷日志到磁盘。测试此时插入10W条记录的时间。</p>
<div>
<div class="cnblogs_code">
<pre>mysql<span style="color: #808080;">&gt;</span> call <span style="color: #0000ff;">proc</span>(<span style="color: #800000; font-weight: bold;">100000</span><span style="color: #000000;">);
Query OK, </span><span style="color: #800000; font-weight: bold;">0</span> rows affected (<span style="color: #800000; font-weight: bold;">15.48</span> sec)</pre>
</div>
</div>
<p class="01">结果是15.48秒。</p>
<p class="01">再测试值为2的时候，即每次提交都刷新到os buffer，但每秒才刷入磁盘中。</p>
<div>
<div class="cnblogs_code">
<pre>mysql<span style="color: #808080;">&gt;</span> <span style="color: #0000ff;">set</span> <span style="color: #008000; font-weight: bold;">@@global</span>.innodb_flush_log_at_trx_commit<span style="color: #808080;">=</span><span style="color: #800000; font-weight: bold;">2</span><span style="color: #000000;">;    
mysql</span><span style="color: #808080;">&gt;</span> <span style="color: #0000ff;">truncate</span><span style="color: #000000;"> test_flush_log;

mysql</span><span style="color: #808080;">&gt;</span> call <span style="color: #0000ff;">proc</span>(<span style="color: #800000; font-weight: bold;">100000</span><span style="color: #000000;">);
Query OK, </span><span style="color: #800000; font-weight: bold;">0</span> rows affected (<span style="color: #800000; font-weight: bold;">3.41</span> sec)</pre>
</div>
</div>
<p class="01">结果插入时间大减，只需3.41秒。</p>
<p class="01">最后测试值为0的时候，即每秒才刷到os buffer和磁盘。</p>
<div>
<div class="cnblogs_code">
<pre>mysql<span style="color: #808080;">&gt;</span> <span style="color: #0000ff;">set</span> <span style="color: #008000; font-weight: bold;">@@global</span>.innodb_flush_log_at_trx_commit<span style="color: #808080;">=</span><span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;">;
mysql</span><span style="color: #808080;">&gt;</span> <span style="color: #0000ff;">truncate</span><span style="color: #000000;"> test_flush_log;

mysql</span><span style="color: #808080;">&gt;</span> call <span style="color: #0000ff;">proc</span>(<span style="color: #800000; font-weight: bold;">100000</span><span style="color: #000000;">);
Query OK, </span><span style="color: #800000; font-weight: bold;">0</span> rows affected (<span style="color: #800000; font-weight: bold;">2.10</span> sec)</pre>
</div>
</div>
<p class="01">结果只有2.10秒。</p>
<p class="01">最后可以发现，其实值为2和0的时候，它们的差距并不太大，但2却比0要安全的多。它们都是每秒从os buffer刷到磁盘，它们之间的时间差体现在log buffer刷到os buffer上。因为将log buffer中的日志刷新到os buffer只是内存数据的转移，并没有太大的开销，所以每次提交和每秒刷入差距并不大。可以测试插入更多的数据来比较，以下是插入100W行数据的情况。从结果可见，值为2和0的时候差距并不大，但值为1的性能却差太多。</p>
<p class="01"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/733013-20180508105836098-1767966445.png" alt=""></p>
<p class="01">尽管设置为0和2可以大幅度提升插入性能，但是在故障的时候可能会丢失1秒钟数据，这1秒钟很可能有大量的数据，从上面的测试结果看，100W条记录也只消耗了20多秒，1秒钟大约有4W-5W条数据，尽管上述插入的数据简单，但却说明了数据丢失的大量性。<span style="color: #ff0000;"><strong>更好的插入数据的做法是将值设置为</strong><strong>1</strong><strong>，然后修改存储过程，将每次循环都提交修改为只提交一次</strong></span><strong>，</strong>这样既能保证数据的一致性，也能提升性能，修改如下：</p>
<div>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #0000ff;">drop</span> <span style="color: #0000ff;">procedure</span> <span style="color: #0000ff;">if</span> <span style="color: #808080;">exists</span> <span style="color: #0000ff;">proc</span><span style="color: #000000;">;
delimiter $$
</span><span style="color: #0000ff;">create</span> <span style="color: #0000ff;">procedure</span> <span style="color: #0000ff;">proc</span>(i <span style="color: #0000ff;">int</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">begin</span>
    <span style="color: #0000ff;">declare</span> s <span style="color: #0000ff;">int</span> <span style="color: #0000ff;">default</span> <span style="color: #800000; font-weight: bold;">1</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">declare</span> c <span style="color: #0000ff;">char</span>(<span style="color: #800000; font-weight: bold;">50</span>) <span style="color: #0000ff;">default</span> repeat(<span style="color: #ff0000;">'</span><span style="color: #ff0000;">a</span><span style="color: #ff0000;">'</span>,<span style="color: #800000; font-weight: bold;">50</span><span style="color: #000000;">);
    start </span><span style="color: #0000ff;">transaction</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">while</span> s<span style="color: #808080;">&lt;=</span><span style="color: #000000;">i DO
        </span><span style="color: #0000ff;">insert</span> <span style="color: #0000ff;">into</span> test_flush_log <span style="color: #0000ff;">values</span>(<span style="color: #0000ff;">null</span><span style="color: #000000;">,c);
        </span><span style="color: #0000ff;">set</span> s<span style="color: #808080;">=</span>s<span style="color: #808080;">+</span><span style="color: #800000; font-weight: bold;">1</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">end</span> <span style="color: #0000ff;">while</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">commit</span><span style="color: #000000;">;
</span><span style="color: #0000ff;">end</span><span style="color: #000000;">$$
delimiter ;</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/copycode.gif" alt="复制代码"></a></span></div></div>
</div>
<p>测试值为1时的情况。</p>
<div>
<div class="cnblogs_code">
<pre>mysql<span style="color: #808080;">&gt;</span> <span style="color: #0000ff;">set</span> <span style="color: #008000; font-weight: bold;">@@global</span>.innodb_flush_log_at_trx_commit<span style="color: #808080;">=</span><span style="color: #800000; font-weight: bold;">1</span><span style="color: #000000;">;
mysql</span><span style="color: #808080;">&gt;</span> <span style="color: #0000ff;">truncate</span><span style="color: #000000;"> test_flush_log;

mysql</span><span style="color: #808080;">&gt;</span> call <span style="color: #0000ff;">proc</span>(<span style="color: #800000; font-weight: bold;">1000000</span><span style="color: #000000;">);
Query OK, </span><span style="color: #800000; font-weight: bold;">0</span> rows affected (<span style="color: #800000; font-weight: bold;">11.26</span> sec)</pre>
</div>
</div>
<p><a name="blog1.3"></a></p>
<h2 id="auto_id_3">1.3 日志块(log block)</h2>
<p class="01">innodb存储引擎中，redo log以块为单位进行存储的，每个块占512字节，这称为redo log block。所以不管是log buffer中还是os buffer中以及redo log file on disk中，都是这样以512字节的块存储的。</p>
<p class="01">每个redo log block由3部分组成：<span style="color: #ff0000;"><strong>日志块头、日志块尾和日志主体</strong></span>。其中日志块头占用12字节，日志块尾占用8字节，所以每个redo log block的日志主体部分只有512-12-8=492字节。</p>
<p class="a"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/733013-20180508182701906-2079813573.png" alt=""></p>
<p class="01">因为redo log记录的是数据页的变化，当一个数据页产生的变化需要使用超过492字节()的redo log来记录，那么就会使用多个redo log block来记录该数据页的变化。</p>
<p class="01">日志块头包含4部分：</p>
<ul>
<li class="a0"> log_block_hdr_no：(4字节)该日志块在redo log buffer中的位置ID。</li>
<li class="a0"> log_block_hdr_data_len：(2字节)该log block中已记录的log大小。写满该log block时为0x200，表示512字节。</li>
<li class="a0"> log_block_first_rec_group：(2字节)该log block中第一个log的开始偏移位置。</li>
<li class="a0"> lock_block_checkpoint_no：(4字节)写入检查点信息的位置。</li>
</ul>
<p class="01">关于log block块头的第三部分&nbsp;<span class="cnblogs_code">log_block_first_rec_group</span>&nbsp;，因为有时候一个数据页产生的日志量超出了一个日志块，这是需要用多个日志块来记录该页的相关日志。例如，某一数据页产生了552字节的日志量，那么需要占用两个日志块，第一个日志块占用492字节，第二个日志块需要占用60个字节，那么对于第二个日志块来说，它的第一个log的开始位置就是73字节(60+12)。如果该部分的值和&nbsp;<span class="cnblogs_code">log_block_hdr_data_len</span>&nbsp;相等，则说明该log block中没有新开始的日志块，即表示该日志块用来延续前一个日志块。</p>
<p class="01">日志尾只有一个部分：&nbsp;<span class="cnblogs_code">log_block_trl_no</span>&nbsp;，该值和块头的&nbsp;<span class="cnblogs_code">log_block_hdr_no</span>&nbsp;相等。</p>
<p class="01">上面所说的是一个日志块的内容，在redo log buffer或者redo log file on disk中，由很多log block组成。如下图：</p>
<p><img src="./详细分析MySQL事务日志(redo log和undo log)_files/733013-20180508182756285-1761418702.png" alt=""></p>
<p><a name="blog1.4"></a></p>
<h2 id="auto_id_4">1.4 log group和redo log file</h2>
<p class="01">log group表示的是redo log group，一个组内由多个大小完全相同的redo log file组成。组内redo log file的数量由变量&nbsp;<span class="cnblogs_code">innodb_log_files_group</span>&nbsp;决定，默认值为2，即两个redo log file。这个组是一个逻辑的概念，并没有真正的文件来表示这是一个组，但是可以通过变量&nbsp;<span class="cnblogs_code">innodb_log_group_home_dir</span>&nbsp;来定义组的目录，redo log file都放在这个目录下，默认是在datadir下。</p>
<div>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/copycode.gif" alt="复制代码"></a></span></div>
<pre>mysql<span style="color: #808080;">&gt;</span> show global variables <span style="color: #808080;">like</span> "innodb_log<span style="color: #808080;">%</span><span style="color: #000000;">";
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">---------------------------+----------+</span>
<span style="color: #808080;">|</span> Variable_name               <span style="color: #808080;">|</span> Value    <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">---------------------------+----------+</span>
<span style="color: #808080;">|</span> innodb_log_buffer_size      <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">8388608</span>  <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span> innodb_log_compressed_pages <span style="color: #808080;">|</span> <span style="color: #0000ff;">ON</span>       <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span> innodb_log_file_size        <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">50331648</span> <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span> innodb_log_files_in_group   <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">2</span>        <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span> innodb_log_group_home_dir   <span style="color: #808080;">|</span> .<span style="color: #808080;">/</span>       <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">---------------------------+----------+</span>

<span style="color: #ff0000;">[</span><span style="color: #ff0000;">root@xuexi data</span><span style="color: #ff0000;">]</span># ll <span style="color: #808080;">/</span>mydata<span style="color: #808080;">/</span>data<span style="color: #808080;">/</span>ib<span style="color: #808080;">*</span>
<span style="color: #808080;">-</span>rw<span style="color: #808080;">-</span>rw<span style="color: #008080;">--</span><span style="color: #008080;">-- 1 mysql mysql 79691776 Mar 30 23:12 /mydata/data/ibdata1</span>
<span style="color: #808080;">-</span>rw<span style="color: #808080;">-</span>rw<span style="color: #008080;">--</span><span style="color: #008080;">-- 1 mysql mysql 50331648 Mar 30 23:12 /mydata/data/ib_logfile0</span>
<span style="color: #808080;">-</span>rw<span style="color: #808080;">-</span>rw<span style="color: #008080;">--</span><span style="color: #008080;">-- 1 mysql mysql 50331648 Mar 30 23:12 /mydata/data/ib_logfile1</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/copycode.gif" alt="复制代码"></a></span></div></div>
</div>
<p class="01">可以看到在默认的数据目录下，有两个ib_logfile开头的文件，它们就是log group中的redo log file，而且它们的大小完全一致且等于变量&nbsp;<span class="cnblogs_code">innodb_log_file_size</span>&nbsp;定义的值。第一个文件ibdata1是在没有开启&nbsp;<span class="cnblogs_code">innodb_file_per_table</span>&nbsp;时的共享表空间文件，对应于开启&nbsp;<span class="cnblogs_code">innodb_file_per_table</span>&nbsp;时的.ibd文件。</p>
<p class="01">在innodb将log buffer中的redo log block刷到这些log file中时，会以追加写入的方式循环轮训写入。即先在第一个log file（即ib_logfile0）的尾部追加写，直到满了之后向第二个log file（即ib_logfile1）写。当第二个log file满了会清空一部分第一个log file继续写入。</p>
<p class="01">由于是将log buffer中的日志刷到log file，所以在log file中记录日志的方式也是log block的方式。</p>
<p class="01">在每个组的第一个redo log file中，前2KB记录4个特定的部分，从2KB之后才开始记录log block。除了第一个redo log file中会记录，log group中的其他log file不会记录这2KB，但是却会腾出这2KB的空间。如下：</p>
<p class="a"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/733013-20180508183757511-1174307952.png" alt=""></p>
<p class="01">redo log file的大小对innodb的性能影响非常大，设置的太大，恢复的时候就会时间较长，设置的太小，就会导致在写redo log的时候循环切换redo log file。</p>
<p><a name="blog1.5"></a></p>
<h2 id="auto_id_5">1.5 redo log的格式</h2>
<p class="01">因为innodb存储引擎存储数据的单元是页(和SQL Server中一样)，所以redo log也是基于页的格式来记录的。默认情况下，innodb的页大小是16KB(由&nbsp;<span class="cnblogs_code">innodb_page_size</span>&nbsp;变量控制)，一个页内可以存放非常多的log block(每个512字节)，而log block中记录的又是数据页的变化。</p>
<p class="01">其中log block中492字节的部分是log body，该log body的格式分为4部分：</p>
<ul>
<li class="a">redo_log_type：占用1个字节，表示redo log的日志类型。</li>
<li class="a">space：表示表空间的ID，采用压缩的方式后，占用的空间可能小于4字节。</li>
<li class="a">page_no：表示页的偏移量，同样是压缩过的。</li>
<li class="a">redo_log_body表示每个重做日志的数据部分，恢复时会调用相应的函数进行解析。例如insert语句和delete语句写入redo log的内容是不一样的。</li>
</ul>
<p class="01">如下图，分别是insert和delete大致的记录方式。</p>
<p><img src="./详细分析MySQL事务日志(redo log和undo log)_files/733013-20180508184303598-1449455496.png" alt=""></p>
<p><a name="blog1.6"></a></p>
<h2 id="auto_id_6">1.6 日志刷盘的规则</h2>
<p class="01">log buffer中未刷到磁盘的日志称为脏日志(dirty log)。</p>
<p class="01">在上面的说过，默认情况下事务每次提交的时候都会刷事务日志到磁盘中，这是因为变量&nbsp;<span class="cnblogs_code">innodb_flush_log_at_trx_commit</span>&nbsp;的值为1。但是innodb不仅仅只会在有commit动作后才会刷日志到磁盘，这只是innodb存储引擎刷日志的规则之一。</p>
<p class="01">刷日志到磁盘有以下几种规则：</p>
<p class="a"><span style="color: #ff0000;"><strong>1.发出commit动作时。已经说明过，commit发出后是否刷日志由变量&nbsp;<span class="cnblogs_code">innodb_flush_log_at_trx_commit</span>&nbsp;控制。</strong></span></p>
<p class="a"><span style="color: #ff0000;"><strong>2.每秒刷一次。这个刷日志的频率由变量&nbsp;<span class="cnblogs_code">innodb_flush_log_at_timeout</span>&nbsp;值决定，默认是1秒。要注意，这个刷日志频率和commit动作无关。</strong></span></p>
<p class="a"><span style="color: #ff0000;"><strong>3.当log buffer中已经使用的内存超过一半时。</strong></span></p>
<p class="a"><span style="color: #ff0000;"><strong>4.当有checkpoint时，checkpoint在一定程度上代表了刷到磁盘时日志所处的LSN位置。</strong></span></p>
<p><a name="blog1.7"></a></p>
<h2 id="auto_id_7">1.7 数据页刷盘的规则及checkpoint</h2>
<p class="01">内存中(buffer pool)未刷到磁盘的数据称为脏数据(dirty data)。由于数据和日志都以页的形式存在，所以脏页表示脏数据和脏日志。</p>
<p class="01">上一节介绍了日志是何时刷到磁盘的，不仅仅是日志需要刷盘，脏数据页也一样需要刷盘。</p>
<p class="01"><strong><span style="color: #ff0000;">在innodb中，数据刷盘的规则只有一个：checkpoint。</span></strong>但是触发checkpoint的情况却有几种。<span style="color: #ff0000;"><strong>不管怎样，</strong><strong>checkpoint</strong><strong>触发后，会将buffer</strong><strong>中脏数据页和脏日志页都刷到磁盘。</strong></span></p>
<p class="01">innodb存储引擎中checkpoint分为两种：</p>
<ul>
<li class="a">sharp checkpoint：在重用redo log文件(例如切换日志文件)的时候，将所有已记录到redo log中对应的脏数据刷到磁盘。</li>
<li class="a">fuzzy checkpoint：一次只刷一小部分的日志到磁盘，而非将所有脏日志刷盘。有以下几种情况会触发该检查点：
<ul>
<li>master thread checkpoint：由master线程控制，<strong><span style="color: #ff0000;">每秒或每10秒</span></strong>刷入一定比例的脏页到磁盘。</li>
<li>flush_lru_list checkpoint：从MySQL5.6开始可通过&nbsp;<span class="cnblogs_code">innodb_page_cleaners</span>&nbsp;变量指定专门负责脏页刷盘的page cleaner线程的个数，该线程的目的是为了保证lru列表有可用的空闲页。</li>
<li>async/sync flush checkpoint：同步刷盘还是异步刷盘。例如还有非常多的脏页没刷到磁盘(非常多是多少，有比例控制)，这时候会选择同步刷到磁盘，但这很少出现；如果脏页不是很多，可以选择异步刷到磁盘，如果脏页很少，可以暂时不刷脏页到磁盘</li>
<li>dirty page too much checkpoint：脏页太多时强制触发检查点，目的是为了保证缓存有足够的空闲空间。too much的比例由变量&nbsp;<span class="cnblogs_code">innodb_max_dirty_pages_pct</span>&nbsp;控制，MySQL 5.6默认的值为75，即当脏页占缓冲池的百分之75后，就强制刷一部分脏页到磁盘。</li>
</ul>
</li>
</ul>
<p class="01">由于刷脏页需要一定的时间来完成，所以记录检查点的位置是在每次刷盘结束之后才在redo log中标记的。</p>
<blockquote>
<p class="a">MySQL停止时是否将脏数据和脏日志刷入磁盘，由变量innodb_fast_shutdown={ 0|1|2 }控制，默认值为1，即停止时只做一部分purge，忽略大多数flush操作(但至少会刷日志)，在下次启动的时候再flush剩余的内容，实现fast shutdown。</p>
</blockquote>
<p><a name="blog1.8"></a></p>
<h2 id="auto_id_8">1.8 LSN超详细分析</h2>
<p class="01">LSN称为日志的逻辑序列号(log sequence number)，在innodb存储引擎中，lsn占用8个字节。LSN的值会随着日志的写入而逐渐增大。</p>
<p class="01">根据LSN，可以获取到几个有用的信息：</p>
<p class="01">1.数据页的版本信息。</p>
<p class="01">2.写入的日志总量，通过LSN开始号码和结束号码可以计算出写入的日志量。</p>
<p class="01">3.可知道检查点的位置。</p>
<p class="01">实际上还可以获得很多隐式的信息。</p>
<p class="01">LSN不仅存在于redo log中，还存在于数据页中，在每个数据页的头部，有一个<span style="color: #ff0000;"><em>fil_page_lsn</em></span>记录了当前页最终的LSN值是多少。通过数据页中的LSN值和redo log中的LSN值比较，如果页中的LSN值小于redo log中LSN值，则表示数据丢失了一部分，这时候可以通过redo log的记录来恢复到redo log中记录的LSN值时的状态。</p>
<p class="01">redo log的lsn信息可以通过&nbsp;<span class="cnblogs_code">show engine innodb status</span>&nbsp;来查看。MySQL 5.5版本的show结果中只有3条记录，没有pages flushed up to。</p>
<div>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/copycode.gif" alt="复制代码"></a></span></div>
<pre>mysql<span style="color: #808080;">&gt;</span><span style="color: #000000;"> show engine innodb stauts
</span><span style="color: #008080;">--</span><span style="color: #008080;">-</span>
<span style="color: #ff00ff;">LOG</span>
<span style="color: #008080;">--</span><span style="color: #008080;">-</span>
<span style="color: #ff00ff;">Log</span> sequence <span style="color: #0000ff;">number</span> <span style="color: #800000; font-weight: bold;">2225502463</span>
<span style="color: #ff00ff;">Log</span> flushed up <span style="color: #0000ff;">to</span>   <span style="color: #800000; font-weight: bold;">2225502463</span><span style="color: #000000;">
Pages flushed up </span><span style="color: #0000ff;">to</span> <span style="color: #800000; font-weight: bold;">2225502463</span><span style="color: #000000;">
Last </span><span style="color: #0000ff;">checkpoint</span> at  <span style="color: #800000; font-weight: bold;">2225502463</span>
<span style="color: #800000; font-weight: bold;">0</span> pending <span style="color: #ff00ff;">log</span> writes, <span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;"> pending chkp writes
</span><span style="color: #800000; font-weight: bold;">3201299</span> <span style="color: #ff00ff;">log</span> i<span style="color: #808080;">/</span>o<span style="color: #ff0000;">'</span><span style="color: #ff0000;">s done, 0.00 log i/o</span><span style="color: #ff0000;">'</span>s<span style="color: #808080;">/</span>second</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/copycode.gif" alt="复制代码"></a></span></div></div>
</div>
<p class="01">其中：</p>
<ul>
<li class="a"><strong>log sequence number就是当前的redo log(in buffer)中的lsn；</strong></li>
<li class="a"><strong>log flushed up to是刷到redo log file on disk中的lsn；</strong></li>
<li class="a"><strong>pages flushed up to是已经刷到磁盘数据页上的LSN；</strong></li>
<li class="a"><strong>last checkpoint at是上一次检查点所在位置的LSN。</strong></li>
</ul>
<p class="01">innodb从执行修改语句开始：</p>
<p class="01">(1).首先修改内存中的数据页，并在数据页中记录LSN，暂且称之为data_in_buffer_lsn；</p>
<p class="01">(2).并且在修改数据页的同时(几乎是同时)向redo log in buffer中写入redo log，并记录下对应的LSN，暂且称之为redo_log_in_buffer_lsn；</p>
<p class="01">(3).写完buffer中的日志后，当触发了日志刷盘的几种规则时，会向redo log file on disk刷入重做日志，并在该文件中记下对应的LSN，暂且称之为redo_log_on_disk_lsn；</p>
<p class="01">(4).数据页不可能永远只停留在内存中，在某些情况下，会触发checkpoint来将内存中的脏页(数据脏页和日志脏页)刷到磁盘，所以会在本次checkpoint脏页刷盘结束时，在redo log中记录checkpoint的LSN位置，暂且称之为checkpoint_lsn。</p>
<p class="01">(5).要记录checkpoint所在位置很快，只需简单的设置一个标志即可，但是刷数据页并不一定很快，例如这一次checkpoint要刷入的数据页非常多。也就是说要刷入所有的数据页需要一定的时间来完成，中途刷入的每个数据页都会记下当前页所在的LSN，暂且称之为data_page_on_disk_lsn。</p>
<p class="01">详细说明如下图：</p>
<p class="01"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/733013-20190321200630187-1720258576.png" alt=""></p>
<p>上图中，从上到下的横线分别代表：时间轴、buffer中数据页中记录的LSN(data_in_buffer_lsn)、磁盘中数据页中记录的LSN(data_page_on_disk_lsn)、buffer中重做日志记录的LSN(redo_log_in_buffer_lsn)、磁盘中重做日志文件中记录的LSN(redo_log_on_disk_lsn)以及检查点记录的LSN(checkpoint_lsn)。</p>
<p class="01">假设在最初时(12:0:00)所有的日志页和数据页都完成了刷盘，也记录好了检查点的LSN，这时它们的LSN都是完全一致的。</p>
<p class="01">假设此时开启了一个事务，并立刻执行了一个update操作，执行完成后，buffer中的数据页和redo log都记录好了更新后的LSN值，假设为110。这时候如果执行&nbsp;<span class="cnblogs_code">show engine innodb status</span>&nbsp;查看各LSN的值，即图中①处的位置状态，结果会是：</p>
<div class="cnblogs_code">
<pre><span style="color: #ff00ff;">log</span> sequence <span style="color: #0000ff;">number</span>(<span style="color: #800000; font-weight: bold;">110</span>) <span style="color: #808080;">&gt;</span> <span style="color: #ff00ff;">log</span> flushed up <span style="color: #0000ff;">to</span>(<span style="color: #800000; font-weight: bold;">100</span>) <span style="color: #808080;">=</span> pages flushed up <span style="color: #0000ff;">to</span> <span style="color: #808080;">=</span> last <span style="color: #0000ff;">checkpoint</span> at</pre>
</div>
<p class="01">之后又执行了一个delete语句，LSN增长到150。等到12:00:01时，触发redo log刷盘的规则(其中有一个规则是&nbsp;<span class="cnblogs_code">innodb_flush_log_at_timeout</span>&nbsp;控制的默认日志刷盘频率为1秒)，这时redo log file on disk中的LSN会更新到和redo log in buffer的LSN一样，所以都等于150，这时&nbsp;<span class="cnblogs_code">show engine innodb status</span>&nbsp;，即图中②的位置，结果将会是：</p>
<div class="cnblogs_code">
<pre><span style="color: #ff00ff;">log</span> sequence <span style="color: #0000ff;">number</span>(<span style="color: #800000; font-weight: bold;">150</span>) <span style="color: #808080;">=</span> <span style="color: #ff00ff;">log</span> flushed up <span style="color: #0000ff;">to</span> <span style="color: #808080;">&gt;</span> pages flushed up <span style="color: #0000ff;">to</span>(<span style="color: #800000; font-weight: bold;">100</span>) <span style="color: #808080;">=</span> last <span style="color: #0000ff;">checkpoint</span> at</pre>
</div>
<p class="01">再之后，执行了一个update语句，缓存中的LSN将增长到300，即图中③的位置。</p>
<p class="01">假设随后检查点出现，即图中④的位置，正如前面所说，检查点会触发数据页和日志页刷盘，但需要一定的时间来完成，所以在数据页刷盘还未完成时，检查点的LSN还是上一次检查点的LSN，但此时磁盘上数据页和日志页的LSN已经增长了，即：</p>
<div class="cnblogs_code">
<pre><span style="color: #ff00ff;">log</span> sequence <span style="color: #0000ff;">number</span> <span style="color: #808080;">&gt;</span> <span style="color: #ff00ff;">log</span> flushed up <span style="color: #0000ff;">to</span> 和 pages flushed up <span style="color: #0000ff;">to</span> <span style="color: #808080;">&gt;</span> last <span style="color: #0000ff;">checkpoint</span> at</pre>
</div>
<p class="01">但是log flushed up to和pages flushed up to的大小无法确定，因为日志刷盘可能快于数据刷盘，也可能等于，还可能是慢于。但是checkpoint机制有保护数据刷盘速度是慢于日志刷盘的：当数据刷盘速度超过日志刷盘时，将会暂时停止数据刷盘，等待日志刷盘进度超过数据刷盘。</p>
<p class="01">等到数据页和日志页刷盘完毕，即到了位置⑤的时候，所有的LSN都等于300。</p>
<p class="01">随着时间的推移到了12:00:02，即图中位置⑥，又触发了日志刷盘的规则，但此时buffer中的日志LSN和磁盘中的日志LSN是一致的，所以不执行日志刷盘，即此时&nbsp;<span class="cnblogs_code">show engine innodb status</span>&nbsp;时各种lsn都相等。</p>
<p class="01">随后执行了一个insert语句，假设buffer中的LSN增长到了800，即图中位置⑦。此时各种LSN的大小和位置①时一样。</p>
<p class="01">随后执行了提交动作，即位置⑧。默认情况下，提交动作会触发日志刷盘，但不会触发数据刷盘，所以&nbsp;<span class="cnblogs_code">show engine innodb status</span>&nbsp;的结果是：</p>
<div class="cnblogs_code">
<pre><span style="color: #ff00ff;">log</span> sequence <span style="color: #0000ff;">number</span> <span style="color: #808080;">=</span> <span style="color: #ff00ff;">log</span> flushed up <span style="color: #0000ff;">to</span> <span style="color: #808080;">&gt;</span> pages flushed up <span style="color: #0000ff;">to</span> <span style="color: #808080;">=</span> last <span style="color: #0000ff;">checkpoint</span> at</pre>
</div>
<p class="01">最后随着时间的推移，检查点再次出现，即图中位置⑨。但是这次检查点不会触发日志刷盘，因为日志的LSN在检查点出现之前已经同步了。假设这次数据刷盘速度极快，快到一瞬间内完成而无法捕捉到状态的变化，这时&nbsp;<span class="cnblogs_code">show engine innodb status</span>&nbsp;的结果将是各种LSN相等。</p>
<p><a name="blog1.9"></a></p>
<h2 id="auto_id_9">1.9 innodb的恢复行为</h2>
<p class="01">在启动innodb的时候，不管上次是正常关闭还是异常关闭，总是会进行恢复操作。</p>
<p class="01">因为redo log记录的是数据页的物理变化，因此恢复的时候速度比逻辑日志(如二进制日志)要快很多。而且，innodb自身也做了一定程度的优化，让恢复速度变得更快。</p>
<p class="01">重启innodb时，checkpoint表示已经完整刷到磁盘上data page上的LSN，因此恢复时仅需要恢复从checkpoint开始的日志部分。例如，当数据库在上一次checkpoint的LSN为10000时宕机，且事务是已经提交过的状态。启动数据库时会检查磁盘中数据页的LSN，如果数据页的LSN小于日志中的LSN，则会从检查点开始恢复。</p>
<p class="01">还有一种情况，在宕机前正处于checkpoint的刷盘过程，且数据页的刷盘进度超过了日志页的刷盘进度。这时候一宕机，数据页中记录的LSN就会大于日志页中的LSN，在重启的恢复过程中会检查到这一情况，这时超出日志进度的部分将不会重做，因为这本身就表示已经做过的事情，无需再重做。</p>
<p class="01">另外，事务日志具有幂等性，所以多次操作得到同一结果的行为在日志中只记录一次。而二进制日志不具有幂等性，多次操作会全部记录下来，在恢复的时候会多次执行二进制日志中的记录，速度就慢得多。例如，某记录中id初始值为2，通过update将值设置为了3，后来又设置成了2，在事务日志中记录的将是无变化的页，根本无需恢复；而二进制会记录下两次update操作，恢复时也将执行这两次update操作，速度比事务日志恢复更慢。</p>
<p><a name="blog1.10"></a></p>
<h2 id="auto_id_10">1.10 和redo log有关的几个变量</h2>
<ul>
<li>innodb_flush_log_at_trx_commit={0|1|2} # 指定何时将事务日志刷到磁盘，默认为1。
<ul>
<li>0表示每秒将"log buffer"同步到"os buffer"且从"os buffer"刷到磁盘日志文件中。</li>
<li>1表示每事务提交都将"log buffer"同步到"os buffer"且从"os buffer"刷到磁盘日志文件中。</li>
<li>2表示每事务提交都将"log buffer"同步到"os buffer"但每秒才从"os buffer"刷到磁盘日志文件中。</li>
</ul>
</li>
<li>innodb_log_buffer_size：# log buffer的大小，默认8M</li>
<li>innodb_log_file_size：#事务日志的大小，默认5M</li>
<li>innodb_log_files_group =2：# 事务日志组中的事务日志文件个数，默认2个</li>
<li>innodb_log_group_home_dir =./：# 事务日志组路径，当前目录表示数据目录</li>
<li>innodb_mirrored_log_groups =1：# 指定事务日志组的镜像组个数，但镜像功能好像是强制关闭的，所以只有一个log group。在MySQL5.7中该变量已经移除。</li>
</ul>
<p><a name="blog2"></a></p>
<h1 id="auto_id_11">2.undo log</h1>
<p><a name="blog2.1"></a></p>
<h2 id="auto_id_12">2.1 基本概念</h2>
<p>undo log有两个作用：提供回滚和多个行版本控制(MVCC)。</p>
<p class="01">在数据修改的时候，不仅记录了redo，还记录了相对应的undo，如果因为某些原因导致事务失败或回滚了，可以借助该undo进行回滚。</p>
<p class="01">undo log和redo log记录物理日志不一样，它是逻辑日志。<strong><span style="color: #ff0000;">可以认为当delete一条记录时，undo log中会记录一条对应的insert记录，反之亦然，当update一条记录时，它记录一条对应相反的update记录。</span></strong></p>
<p class="01">当执行rollback时，就可以从undo log中的逻辑记录读取到相应的内容并进行回滚。有时候应用到行版本控制的时候，也是通过undo log来实现的：当读取的某一行被其他事务锁定时，它可以从undo log中分析出该行记录以前的数据是什么，从而提供该行版本信息，让用户实现非锁定一致性读取。</p>
<p class="01"><span style="color: #ff0000;"><strong>undo log</strong><strong>是采用段(segment)</strong><strong>的方式来记录的，每个undo</strong><strong>操作在记录的时候占用一个undo log segment</strong><strong>。</strong></span></p>
<p class="01">另外，<span style="color: #ff0000;"><strong>undo log</strong><strong>也会产生redo log</strong><strong>，因为undo log</strong><strong>也要实现持久性保护。</strong></span></p>
<p><a name="blog2.2"></a></p>
<h2 id="auto_id_13">2.2 undo log的存储方式</h2>
<p class="01">innodb存储引擎对undo的管理采用段的方式。<span style="color: #ff0000;"><strong>rollback segment</strong><strong>称为回滚段，每个回滚段中有1024</strong><strong>个undo log segment</strong><strong>。</strong></span></p>
<p class="01">在以前老版本，只支持1个rollback segment，这样就只能记录1024个undo log segment。后来MySQL5.5可以支持128个rollback segment，即支持128*1024个undo操作，还可以通过变量&nbsp;<span class="cnblogs_code">innodb_undo_logs</span>&nbsp;(5.6版本以前该变量是&nbsp;<span class="cnblogs_code">innodb_rollback_segments</span>&nbsp;)自定义多少个rollback segment，默认值为128。</p>
<p class="01">undo log默认存放在共享表空间中。</p>
<div>
<div class="cnblogs_code">
<pre><span style="color: #ff0000;">[</span><span style="color: #ff0000;">root@xuexi data</span><span style="color: #ff0000;">]</span># ll <span style="color: #808080;">/</span>mydata<span style="color: #808080;">/</span>data<span style="color: #808080;">/</span>ib<span style="color: #808080;">*</span>
<span style="color: #808080;">-</span>rw<span style="color: #808080;">-</span>rw<span style="color: #008080;">--</span><span style="color: #008080;">-- 1 mysql mysql 79691776 Mar 31 01:42 <em><strong><span style="color: #ff0000;">/mydata/data/ibdata1</span></strong></em></span>
<span style="color: #808080;">-</span>rw<span style="color: #808080;">-</span>rw<span style="color: #008080;">--</span><span style="color: #008080;">-- 1 mysql mysql 50331648 Mar 31 01:42 /mydata/data/ib_logfile0</span>
<span style="color: #808080;">-</span>rw<span style="color: #808080;">-</span>rw<span style="color: #008080;">--</span><span style="color: #008080;">-- 1 mysql mysql 50331648 Mar 31 01:42 /mydata/data/ib_logfile1</span></pre>
</div>
</div>
<p class="01">如果开启了&nbsp;<span class="cnblogs_code">innodb_file_per_table</span>&nbsp;，将放在每个表的.ibd文件中。</p>
<p class="01">在MySQL5.6中，undo的存放位置还可以通过变量&nbsp;<span class="cnblogs_code">innodb_undo_directory</span>&nbsp;来自定义存放目录，默认值为"."表示datadir。</p>
<p class="01">默认rollback segment全部写在一个文件中，但可以通过设置变量&nbsp;<span class="cnblogs_code">innodb_undo_tablespaces</span>&nbsp;平均分配到多少个文件中。该变量默认值为0，即全部写入一个表空间文件。该变量为静态变量，只能在数据库示例停止状态下修改，如写入配置文件或启动时带上对应参数。但是innodb存储引擎在启动过程中提示，不建议修改为非0的值，如下：</p>
<div class="cnblogs_code">
<pre><span style="color: #800000; font-weight: bold;">2017</span><span style="color: #808080;">-</span><span style="color: #800000; font-weight: bold;">03</span><span style="color: #808080;">-</span><span style="color: #800000; font-weight: bold;">31</span> <span style="color: #800000; font-weight: bold;">13</span>:<span style="color: #800000; font-weight: bold;">16</span>:<span style="color: #800000; font-weight: bold;">00</span> 7f665bfab720 InnoDB: Expected <span style="color: #0000ff;">to</span> <span style="color: #0000ff;">open</span> <span style="color: #800000; font-weight: bold;">3</span><span style="color: #000000;"> undo tablespaces but was able
</span><span style="color: #800000; font-weight: bold;">2017</span><span style="color: #808080;">-</span><span style="color: #800000; font-weight: bold;">03</span><span style="color: #808080;">-</span><span style="color: #800000; font-weight: bold;">31</span> <span style="color: #800000; font-weight: bold;">13</span>:<span style="color: #800000; font-weight: bold;">16</span>:<span style="color: #800000; font-weight: bold;">00</span> 7f665bfab720 InnoDB: <span style="color: #0000ff;">to</span> find <span style="color: #0000ff;">only</span> <span style="color: #800000; font-weight: bold;">0</span><span style="color: #000000;"> undo tablespaces.
</span><span style="color: #800000; font-weight: bold;">2017</span><span style="color: #808080;">-</span><span style="color: #800000; font-weight: bold;">03</span><span style="color: #808080;">-</span><span style="color: #800000; font-weight: bold;">31</span> <span style="color: #800000; font-weight: bold;">13</span>:<span style="color: #800000; font-weight: bold;">16</span>:<span style="color: #800000; font-weight: bold;">00</span> 7f665bfab720 InnoDB: <span style="color: #0000ff;">Set</span> the innodb_undo_tablespaces parameter <span style="color: #0000ff;">to</span><span style="color: #000000;"> the
</span><span style="color: #800000; font-weight: bold;">2017</span><span style="color: #808080;">-</span><span style="color: #800000; font-weight: bold;">03</span><span style="color: #808080;">-</span><span style="color: #800000; font-weight: bold;">31</span> <span style="color: #800000; font-weight: bold;">13</span>:<span style="color: #800000; font-weight: bold;">16</span>:<span style="color: #800000; font-weight: bold;">00</span> 7f665bfab720 InnoDB: correct value <span style="color: #808080;">and</span> retry. <em><strong><span style="color: #ff0000;">Suggested value is 0</span></strong></em></pre>
</div>
<p><a name="blog2.3"></a></p>
<h2 id="auto_id_14">2.3 和undo log相关的变量</h2>
<p>undo相关的变量在MySQL5.6中已经变得很少。如下：它们的意义在上文中已经解释了。</p>
<div>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/copycode.gif" alt="复制代码"></a></span></div>
<pre> mysql<span style="color: #808080;">&gt;</span> show variables <span style="color: #808080;">like</span> "<span style="color: #808080;">%</span>undo<span style="color: #808080;">%</span><span style="color: #000000;">";
</span><span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">-----------------------+-------+</span>
<span style="color: #808080;">|</span> Variable_name           <span style="color: #808080;">|</span> Value <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">-----------------------+-------+</span>
<span style="color: #808080;">|</span> innodb_undo_directory   <span style="color: #808080;">|</span> .     <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span> innodb_undo_logs        <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">128</span>   <span style="color: #808080;">|</span>
<span style="color: #808080;">|</span> innodb_undo_tablespaces <span style="color: #808080;">|</span> <span style="color: #800000; font-weight: bold;">0</span>     <span style="color: #808080;">|</span>
<span style="color: #808080;">+</span><span style="color: #008080;">--</span><span style="color: #008080;">-----------------------+-------+</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p><a name="blog2.4"></a></p>
</div>
<h2 id="auto_id_15">2.4 delete/update操作的内部机制</h2>
<p class="01">当事务提交的时候，innodb不会立即删除undo log，因为后续还可能会用到undo log，如隔离级别为repeatable read时，事务读取的都是开启事务时的最新提交行版本，只要该事务不结束，该行版本就不能删除，即undo log不能删除。</p>
<p class="01">但是在事务提交的时候，会将该事务对应的undo log放入到删除列表中，未来通过purge来删除。并且提交事务时，还会判断undo log分配的页是否可以重用，如果可以重用，则会分配给后面来的事务，避免为每个独立的事务分配独立的undo log页而浪费存储空间和性能。</p>
<p class="01">通过undo log记录delete和update操作的结果发现：(insert操作无需分析，就是插入行而已)</p>
<ul>
<li class="a0">delete操作实际上不会直接删除，而是将delete对象打上delete flag，标记为删除，最终的删除操作是purge线程完成的。</li>
<li class="a0">update分为两种情况：update的列是否是主键列。
<ul>
<li class="a1">如果不是主键列，在undo log中直接反向记录是如何update的。即update是直接进行的。</li>
<li class="a1">如果是主键列，update分两部执行：先删除该行，再插入一行目标行。</li>
</ul>
</li>
</ul>
<p>&nbsp;<a name="blog3"></a></p>
<h1 id="auto_id_16">3.binlog和事务日志的先后顺序及group commit</h1>
<p class="01">如果事务不是只读事务，即涉及到了数据的修改，默认情况下会在commit的时候调用fsync()将日志刷到磁盘，保证事务的持久性。</p>
<p class="01">但是一次刷一个事务的日志性能较低，特别是事务集中在某一时刻时事务量非常大的时候。innodb提供了group commit功能，可以将多个事务的事务日志通过一次fsync()刷到磁盘中。</p>
<p class="01">因为事务在提交的时候不仅会记录事务日志，还会记录二进制日志，但是它们谁先记录呢？二进制日志是MySQL的上层日志，先于存储引擎的事务日志被写入。</p>
<p class="01">在MySQL5.6以前，当事务提交(即发出commit指令)后，MySQL接收到该信号进入commit prepare阶段；进入prepare阶段后，立即写内存中的二进制日志，写完内存中的二进制日志后就相当于确定了commit操作；然后开始写内存中的事务日志；最后将二进制日志和事务日志刷盘，它们如何刷盘，分别由变量&nbsp;<span class="cnblogs_code">sync_binlog</span>&nbsp;和&nbsp;<span class="cnblogs_code">innodb_flush_log_at_trx_commit</span>&nbsp;控制。</p>
<p class="01">但因为要保证二进制日志和事务日志的一致性，在提交后的prepare阶段会启用一个<span style="color: #ff0000;"><strong>prepare_commit_mutex</strong></span>锁来保证它们的顺序性和一致性。但这样会导致开启二进制日志后group commmit失效，特别是在主从复制结构中，几乎都会开启二进制日志。</p>
<p class="01">在MySQL5.6中进行了改进。提交事务时，在存储引擎层的上一层结构中会将事务按序放入一个队列，队列中的第一个事务称为leader，其他事务称为follower，leader控制着follower的行为。虽然顺序还是一样先刷二进制，再刷事务日志，但是机制完全改变了：删除了原来的prepare_commit_mutex行为，也能保证即使开启了二进制日志，group commit也是有效的。</p>
<p class="01">MySQL5.6中分为3个步骤：<span style="color: #ff0000;"><strong>flush阶段、sync阶段、commit阶段。</strong></span></p>
<p><img src="./详细分析MySQL事务日志(redo log和undo log)_files/733013-20180508203426454-427168291.png" alt=""></p>
<ul>
<li class="a">flush阶段：向内存中写入每个事务的二进制日志。</li>
<li class="a">sync阶段：将内存中的二进制日志刷盘。若队列中有多个事务，那么仅一次fsync操作就完成了二进制日志的刷盘操作。这在MySQL5.6中称为BLGC(binary log group commit)。</li>
<li class="a">commit阶段：leader根据顺序调用存储引擎层事务的提交，由于innodb本就支持group commit，所以解决了因为锁&nbsp;<span class="cnblogs_code">prepare_commit_mutex</span>&nbsp;而导致的group commit失效问题。</li>
</ul>
<p class="01">在flush阶段写入二进制日志到内存中，但是不是写完就进入sync阶段的，而是要等待一定的时间，多积累几个事务的binlog一起进入sync阶段，等待时间由变量&nbsp;<span class="cnblogs_code">binlog_max_flush_queue_time</span>&nbsp;决定，默认值为0表示不等待直接进入sync，设置该变量为一个大于0的值的好处是group中的事务多了，性能会好一些，但是这样会导致事务的响应时间变慢，所以建议不要修改该变量的值，除非事务量非常多并且不断的在写入和更新。</p>
<p class="01">进入到sync阶段，会将binlog从内存中刷入到磁盘，刷入的数量和单独的二进制日志刷盘一样，由变量&nbsp;<span class="cnblogs_code">sync_binlog</span>&nbsp;控制。</p>
<p class="01">当有一组事务在进行commit阶段时，其他新事务可以进行flush阶段，它们本就不会相互阻塞，所以group commit会不断生效。当然，group commit的性能和队列中的事务数量有关，如果每次队列中只有1个事务，那么group commit和单独的commit没什么区别，当队列中事务越来越多时，即提交事务越多越快时，group commit的效果越明显。</p>
<p>&nbsp;</p><p><strong><span style="font-size: 18px;">转载请注明出处：<a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html">https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html</a></span></strong></p><p><strong><span style="font-size: 18px;">如果觉得文章不错，不妨给个<font color="#0000ff" size="6">打赏</font>，写作不易，各位的支持，能激发和鼓励我更大的写作热情。谢谢！</span></strong><br></p><img src="./详细分析MySQL事务日志(redo log和undo log)_files/wealipay.bmp"><p></p><p></p></div>
<div id="MySignature" style="display: block;"><div>作者：<a href="https://www.cnblogs.com/f-ck-need-u/" target="_blank">骏马金龙</a></div>
<div>出处：<a href="https://www.cnblogs.com/f-ck-need-u/" target="_blank">http://www.cnblogs.com/f-ck-need-u/</a></div>
<div>Linux运维交流群：<a href="https://jq.qq.com/?_wv=1027&amp;k=5zfAfeJ" target="_blank">710427601</a></div>
<p>
	<span style="font-size: 14px; font-family: &quot;Microsoft YaHei&quot;; color: #0000ff">
		<strong>
			<a href="https://www.cnblogs.com/f-ck-need-u/p/7048359.html" target="_blank">
				Linux&amp;shell系列文章：http://www.cnblogs.com/f-ck-need-u/p/7048359.html</a>
		</strong>
		<br>

		<strong>
			<a href="https://www.cnblogs.com/f-ck-need-u/p/7576137.html" target="_blank">
				网站架构系列文章：http://www.cnblogs.com/f-ck-need-u/p/7576137.html</a>
		</strong>
		<br>

		<strong>
			<a href="https://www.cnblogs.com/f-ck-need-u/p/7586194.html" target="_blank">
				MySQL/MariaDB系列文章：https://www.cnblogs.com/f-ck-need-u/p/7586194.html</a>
		</strong>
		<br>

		<strong>
			<a href="https://www.cnblogs.com/f-ck-need-u/p/9512185.html" target="_blank">
				Perl系列：https://www.cnblogs.com/f-ck-need-u/p/9512185.html</a>
		</strong>
		<br>

		<strong>
			<a href="https://www.cnblogs.com/f-ck-need-u/p/9832538.html" target="_blank">
				Go系列：https://www.cnblogs.com/f-ck-need-u/p/9832538.html</a>
		</strong>
		<br>

		<strong>
			<a href="https://www.cnblogs.com/f-ck-need-u/p/9832640.html" target="_blank">
				Python系列：https://www.cnblogs.com/f-ck-need-u/p/9832640.html</a>
		</strong>
		<br>

		<strong>
			<a href="https://www.cnblogs.com/f-ck-need-u/p/10805545.html" target="_blank">
				Ruby系列：https://www.cnblogs.com/f-ck-need-u/p/10805545.html</a>
		</strong>
		<br>

		<strong>
			<a href="https://www.junmajinlong.com/os/index/" target="_blank">
				操作系统系列：https://www.junmajinlong.com/os/index/</a>
		</strong>
		<br><strong> <a href="https://www.junmajinlong.com/shell/awk/index" target="_blank"> 精通awk系列：https://www.junmajinlong.com/shell/awk/index</a> </strong> <br>
	</span>
</p></div>
<div class="clear"></div>
<div id="blog_post_info_block"><div id="BlogPostCategory">
    分类: 
            <a href="https://www.cnblogs.com/f-ck-need-u/category/1085743.html" target="_blank">数据库系列</a></div>


    <div id="blog_post_info">
<div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(9010872,cb_blogId,1);green_channel_success(this,&#39;谢谢推荐！&#39;);">好文要顶</a>
        <a id="green_channel_follow" onclick="follow(&#39;1e7fa90d-decd-e411-b908-9dcfd8948a71&#39;);" href="javascript:void(0);">关注我</a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);">收藏该文</a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/f-ck-need-u/" target="_blank"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/20180330130915.png" class="author_avatar" alt=""></a>
        <div id="author_profile_detail" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/f-ck-need-u/">骏马金龙</a><br>
            <a href="https://home.cnblogs.com/u/f-ck-need-u/followees/">关注 - 24</a><br>
            <a href="https://home.cnblogs.com/u/f-ck-need-u/followers/">粉丝 - 1621</a>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor"></div>
    <div id="author_profile_follow">
                <a href="javascript:void(0);" onclick="follow(&#39;1e7fa90d-decd-e411-b908-9dcfd8948a71&#39;);return false;">+加关注</a>
    </div>
</div>


<script type="text/javascript">
    currentDiggType = 0;
</script></div>
    <div class="clear"></div>
    <div id="post_next_prev">

    <a href="https://www.cnblogs.com/f-ck-need-u/p/9001061.html" class="p_n_p_prefix">« </a> 上一篇：    <a href="https://www.cnblogs.com/f-ck-need-u/p/9001061.html" title="发布于 2018-05-07 09:40">详细分析MySQL的日志(一)</a>
    <br>
    <a href="https://www.cnblogs.com/f-ck-need-u/p/9013458.html" class="p_n_p_prefix">» </a> 下一篇：    <a href="https://www.cnblogs.com/f-ck-need-u/p/9013458.html" title="发布于 2018-05-09 12:24">MariaDB/MySQL备份和恢复(一)：mysqldump工具用法详述</a>

</div>
</div>
            </div>
            <div class="postDesc">posted @ 
<span id="post-date">2018-05-08 20:49</span>&nbsp;
<a href="https://www.cnblogs.com/f-ck-need-u/">骏马金龙</a>&nbsp;
阅读(<span id="post_view_count">50158</span>)&nbsp;
评论(<span id="post_comment_count">12</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=9010872" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(9010872);return false;">收藏</a></div>
        </div>
<script src="./详细分析MySQL事务日志(redo log和undo log)_files/highlight.min.js.下载"></script>
<script>markdown_highlight();</script>
<script>
    var allowComments = true, cb_blogId = 222371, cb_blogApp = 'f-ck-need-u', cb_blogUserGuid = '1e7fa90d-decd-e411-b908-9dcfd8948a71';
    var cb_entryId = 9010872, cb_entryCreatedDate = '2018-05-08 20:49', cb_postType = 1; 
    loadViewCount(cb_entryId);
</script><a name="!comments"></a>
<div id="blog-comments-placeholder">

<div id="comment_pager_top">
    
</div>


<div class="feedback_area_title">评论列表</div>
<div class="feedbackNoItems"></div>

        <div class="feedbackItem">
            <div class="feedbackListSubtitle">
                <div class="feedbackManage">
                    &nbsp;&nbsp;
                    

<span class="comment_actions">
    
    
    
    
</span>


                </div>
                <!-- Title -->
                
<a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4136873" class="layer">#1楼</a>
<a name="4136873" id="comment_anchor_4136873"></a>


                <!-- PostDate -->
                
<span class="comment_date">2018-12-11 17:03</span>


                <!--NameLink-->
                

            <a id="a_comment_author_4136873" href="https://www.cnblogs.com/grotian/" target="_blank">北方漂流</a>

                <div class="feedbackCon">
                    
<div id="comment_body_4136873" data-format-type="Ubb" class="blog_comment_body cnblogs-ubb">
    “1.8 LSN超详细分析”一节中的图示，②和⑧节点上，不应该是 redo log 刷盘在先（是 redo_log_on_disk_lsn 而不是 data_page_on_disk_lsn）吗？
</div>
        <div class="comment_vote">
            <span class="comment_error" style="color: red"></span>
            <a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(4136873, &#39;Digg&#39;, this.parentElement, false);">
                支持(1)
            </a>
            <a href="javascript:void(0);" class="comment_burry" onclick="return voteComment(4136873, &#39;Bury&#39;, this.parentElement, false);">
                反对(0)
            </a>
        </div>
        <span id="comment_4136873_avatar" style="display:none">
            https://pic.cnblogs.com/face/u471665.jpg?id=22212241
        </span>

                </div>
            </div>
        </div>
        <div class="feedbackItem">
            <div class="feedbackListSubtitle">
                <div class="feedbackManage">
                    &nbsp;&nbsp;
                    

<span class="comment_actions">
    
    
    
    
</span>


                </div>
                <!-- Title -->
                
<a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4179391" class="layer">#2楼</a>
<a name="4179391" id="comment_anchor_4179391"></a>


                <!-- PostDate -->
                
<span class="comment_date">2019-02-14 13:16</span>


                <!--NameLink-->
                

            <a id="a_comment_author_4179391" href="https://www.cnblogs.com/cbgu/" target="_blank">纪璋回</a>

                <div class="feedbackCon">
                    
<div id="comment_body_4179391" data-format-type="Ubb" class="blog_comment_body cnblogs-ubb">
    <a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4136873" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,4136873);">@</a>
北方漂流<br>wal机制，日志先行，我理解的是redo log刷盘先于数据页中数据修改，即redo_log_on_disk_lsn先于data_in_buffer_lsn，而非data_page_on_disk_lsn，我是这么理解的。
</div>
        <div class="comment_vote">
            <span class="comment_error" style="color: red"></span>
            <a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(4179391, &#39;Digg&#39;, this.parentElement, false);">
                支持(0)
            </a>
            <a href="javascript:void(0);" class="comment_burry" onclick="return voteComment(4179391, &#39;Bury&#39;, this.parentElement, false);">
                反对(0)
            </a>
        </div>
        <span id="comment_4179391_avatar" style="display:none">
            https://pic.cnblogs.com/face/1164322/20180305140845.png
        </span>

                </div>
            </div>
        </div>
        <div class="feedbackItem">
            <div class="feedbackListSubtitle">
                <div class="feedbackManage">
                    &nbsp;&nbsp;
                    

<span class="comment_actions">
    
    
    
    
</span>


                </div>
                <!-- Title -->
                
<a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4209723" class="layer">#3楼</a>
<a name="4209723" id="comment_anchor_4209723"></a>


                <!-- PostDate -->
                
<span class="comment_date">2019-03-21 19:55</span>


                <!--NameLink-->
                

            <a id="a_comment_author_4209723" href="https://home.cnblogs.com/u/720129/" target="_blank">青春的节奏</a>

                <div class="feedbackCon">
                    
<div id="comment_body_4209723" data-format-type="Ubb" class="blog_comment_body cnblogs-ubb">
    <a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4136873" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,4136873);">@</a>
北方漂流<br>我也觉得是作者画图画反了
</div>
        <div class="comment_vote">
            <span class="comment_error" style="color: red"></span>
            <a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(4209723, &#39;Digg&#39;, this.parentElement, false);">
                支持(0)
            </a>
            <a href="javascript:void(0);" class="comment_burry" onclick="return voteComment(4209723, &#39;Bury&#39;, this.parentElement, false);">
                反对(0)
            </a>
        </div>
        

                </div>
            </div>
        </div>
        <div class="feedbackItem">
            <div class="feedbackListSubtitle">
                <div class="feedbackManage">
                    &nbsp;&nbsp;
                    

<span class="comment_actions">
    
    
    
    
</span>


                </div>
                <!-- Title -->
                
<a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4209735" class="layer">#4楼</a>
<a name="4209735" id="comment_anchor_4209735"></a>
[<span class="louzhu">楼主</span>]

                <!-- PostDate -->
                
<span class="comment_date">2019-03-21 20:04</span>


                <!--NameLink-->
                

            <a id="a_comment_author_4209735" href="https://www.cnblogs.com/f-ck-need-u/" target="_blank">骏马金龙</a>

                <div class="feedbackCon">
                    
<div id="comment_body_4209735" data-format-type="Ubb" class="blog_comment_body cnblogs-ubb">
    <a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4136873" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,4136873);">@</a>
北方漂流<br>@纪璋回<br>@青春的节奏<br>图中②和⑧节点处，data_page_on_disk确实是画错了，不应该画上去。但是下面的文字描述应该是没错的，希望没有影响到你们理解
</div>
        <div class="comment_vote">
            <span class="comment_error" style="color: red"></span>
            <a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(4209735, &#39;Digg&#39;, this.parentElement, false);">
                支持(0)
            </a>
            <a href="javascript:void(0);" class="comment_burry" onclick="return voteComment(4209735, &#39;Bury&#39;, this.parentElement, false);">
                反对(0)
            </a>
        </div>
        <span id="comment_4209735_avatar" style="display:none">
            https://pic.cnblogs.com/face/733013/20180330130915.png
        </span>

                </div>
            </div>
        </div>
        <div class="feedbackItem">
            <div class="feedbackListSubtitle">
                <div class="feedbackManage">
                    &nbsp;&nbsp;
                    

<span class="comment_actions">
    
    
    
    
</span>


                </div>
                <!-- Title -->
                
<a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4266310" class="layer">#5楼</a>
<a name="4266310" id="comment_anchor_4266310"></a>


                <!-- PostDate -->
                
<span class="comment_date">2019-05-27 19:36</span>


                <!--NameLink-->
                

            <a id="a_comment_author_4266310" href="https://www.cnblogs.com/jerry-chin/" target="_blank">Jerry.Chin</a>

                <div class="feedbackCon">
                    
<div id="comment_body_4266310" data-format-type="Ubb" class="blog_comment_body cnblogs-ubb">
    NB! 作者是 MYSQL 开发人员吗？
</div>
        <div class="comment_vote">
            <span class="comment_error" style="color: red"></span>
            <a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(4266310, &#39;Digg&#39;, this.parentElement, false);">
                支持(0)
            </a>
            <a href="javascript:void(0);" class="comment_burry" onclick="return voteComment(4266310, &#39;Bury&#39;, this.parentElement, false);">
                反对(0)
            </a>
        </div>
        <span id="comment_4266310_avatar" style="display:none">
            https://pic.cnblogs.com/face/771706/20200404140532.png
        </span>

                </div>
            </div>
        </div>
        <div class="feedbackItem">
            <div class="feedbackListSubtitle">
                <div class="feedbackManage">
                    &nbsp;&nbsp;
                    

<span class="comment_actions">
    
    
    
    
</span>


                </div>
                <!-- Title -->
                
<a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4312799" class="layer">#6楼</a>
<a name="4312799" id="comment_anchor_4312799"></a>


                <!-- PostDate -->
                
<span class="comment_date">2019-07-30 20:42</span>


                <!--NameLink-->
                

            <a id="a_comment_author_4312799" href="https://www.cnblogs.com/martin-chen/" target="_blank">Web游离者</a>

                <div class="feedbackCon">
                    
<div id="comment_body_4312799" data-format-type="Ubb" class="blog_comment_body cnblogs-ubb">
    @骏马金龙 楼主写的很详细，我也在看《MySQL技术内幕：InnoDB存储引擎》这本书，对于redo log这一块一直有一个疑问未能找到答案，希望能从你这边得到一些帮助。<br>当一个事务启动后，会不断持续的往redo log中写入 log record，但是这个时候事务并未提交，如果这个时候出现 redo log 刷盘，那这部分未提交事务的 log record 也会保存到 redo log file 中，如果在这个时候MySQL服务宕机，重启MySQL时，怎么判断 redo log file 中的 log record 所属的事务是否已经提交呢？
</div>
        <div class="comment_vote">
            <span class="comment_error" style="color: red"></span>
            <a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(4312799, &#39;Digg&#39;, this.parentElement, false);">
                支持(0)
            </a>
            <a href="javascript:void(0);" class="comment_burry" onclick="return voteComment(4312799, &#39;Bury&#39;, this.parentElement, false);">
                反对(0)
            </a>
        </div>
        

                </div>
            </div>
        </div>
        <div class="feedbackItem">
            <div class="feedbackListSubtitle">
                <div class="feedbackManage">
                    &nbsp;&nbsp;
                    

<span class="comment_actions">
    
    
    
    
</span>


                </div>
                <!-- Title -->
                
<a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4312902" class="layer">#7楼</a>
<a name="4312902" id="comment_anchor_4312902"></a>
[<span class="louzhu">楼主</span>]

                <!-- PostDate -->
                
<span class="comment_date">2019-07-30 23:36</span>


                <!--NameLink-->
                

            <a id="a_comment_author_4312902" href="https://www.cnblogs.com/f-ck-need-u/" target="_blank">骏马金龙</a>

                <div class="feedbackCon">
                    
<div id="comment_body_4312902" data-format-type="Ubb" class="blog_comment_body cnblogs-ubb">
    <a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4312799" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,4312799);">@</a>
Web游离者<br>这个很容易判断的。每个事务都有事务ID，对应这个事务ID，提交后都有提交标记。重启服务后检查redo log的时候，发现这个事务没有对应的标记，那么就是未完成事务
</div>
        <div class="comment_vote">
            <span class="comment_error" style="color: red"></span>
            <a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(4312902, &#39;Digg&#39;, this.parentElement, false);">
                支持(0)
            </a>
            <a href="javascript:void(0);" class="comment_burry" onclick="return voteComment(4312902, &#39;Bury&#39;, this.parentElement, false);">
                反对(0)
            </a>
        </div>
        <span id="comment_4312902_avatar" style="display:none">
            https://pic.cnblogs.com/face/733013/20180330130915.png
        </span>

                </div>
            </div>
        </div>
        <div class="feedbackItem">
            <div class="feedbackListSubtitle">
                <div class="feedbackManage">
                    &nbsp;&nbsp;
                    

<span class="comment_actions">
    
    
    
    
</span>


                </div>
                <!-- Title -->
                
<a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4312910" class="layer">#8楼</a>
<a name="4312910" id="comment_anchor_4312910"></a>


                <!-- PostDate -->
                
<span class="comment_date">2019-07-31 00:09</span>


                <!--NameLink-->
                

            <a id="a_comment_author_4312910" href="https://www.cnblogs.com/martin-chen/" target="_blank">Web游离者</a>

                <div class="feedbackCon">
                    
<div id="comment_body_4312910" data-format-type="Ubb" class="blog_comment_body cnblogs-ubb">
    <a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4312902" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,4312902);">@</a>
骏马金龙<br>但是我在看其它文章的时候得到的是另外的一个说法：<a href="http://www.zhdba.com/mysqlops/2012/04/06/innodb-log1/" target="_blank">MySQL数据库InnoDB存储引擎Log漫游(1)</a>。在这篇文章里说MySQL在恢复过程中redo log是没有事务性的。<br><img src="./详细分析MySQL事务日志(redo log和undo log)_files/256297-20190731000851617-1525756580.jpg" alt="" border="0" "="">。<br>但是我觉得这篇文章里的说法还是不能解答我的问题。
</div>
        <div class="comment_vote">
            <span class="comment_error" style="color: red"></span>
            <a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(4312910, &#39;Digg&#39;, this.parentElement, false);">
                支持(0)
            </a>
            <a href="javascript:void(0);" class="comment_burry" onclick="return voteComment(4312910, &#39;Bury&#39;, this.parentElement, false);">
                反对(0)
            </a>
        </div>
        

                </div>
            </div>
        </div>
        <div class="feedbackItem">
            <div class="feedbackListSubtitle">
                <div class="feedbackManage">
                    &nbsp;&nbsp;
                    

<span class="comment_actions">
    
    
    
    
</span>


                </div>
                <!-- Title -->
                
<a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4313909" class="layer">#9楼</a>
<a name="4313909" id="comment_anchor_4313909"></a>
[<span class="louzhu">楼主</span>]

                <!-- PostDate -->
                
<span class="comment_date">2019-07-31 21:51</span>


                <!--NameLink-->
                

            <a id="a_comment_author_4313909" href="https://www.cnblogs.com/f-ck-need-u/" target="_blank">骏马金龙</a>

                <div class="feedbackCon">
                    
<div id="comment_body_4313909" data-format-type="Ubb" class="blog_comment_body cnblogs-ubb">
    <a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4312910" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,4312910);">@</a>
Web游离者<br>每个事务肯定要记录它是否完成啊，否则它如何保证事务的原子性呢？而且就算是还没有提交的事务，都能够查询到这个事务的状态，是运行中、锁等待中、回滚中、提交中，都能够查询到，查询不到的事务一定是已经提交的事务，因为它已经能够保证数据的一致性。<br>至于你说的文章中所说的没有事务性，大概可能的意思是不像逻辑事务一样，有开启和终止事务的语句描述。但是在事务日志里，一定会记录事务是从哪里开始，到那里结束，或者某条log record属于哪个事务，并且记录事务ID。<br><br>在重启mysql服务的时候，会检查事务日志的完整性。分3种情况：<br>1.在宕机之前或mysql停止之前，事务日志和数据已经全部刷到磁盘的redo log，说明事务日志是多余的，那么启动的时候，直接跳过事务日志的检查。<br>2.如果缺少事务日志文件，也会直接跳过事务日志的检查。这可能会导致重启前后数据的不一致。<br>3.你这里所描述的情况，事务日志没有刷完就宕机，也就是说，事务日志的文件是不完整的。<br><br>对于第三种情况，在重启mysql服务时它会在这里重做一部分事务日志，从最近的一个检查点(checkpoint)处开始扫描redo log，当扫描到mysql是非正常关闭时，会从此处开始进入恢复的过程，该回滚的回滚，该前滚的前滚。而未提交的事务(其事务日志的提交点还没有刷入到磁盘redo log)，显然是要回滚的。
</div>
        <div class="comment_vote">
            <span class="comment_error" style="color: red"></span>
            <a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(4313909, &#39;Digg&#39;, this.parentElement, false);">
                支持(0)
            </a>
            <a href="javascript:void(0);" class="comment_burry" onclick="return voteComment(4313909, &#39;Bury&#39;, this.parentElement, false);">
                反对(0)
            </a>
        </div>
        <span id="comment_4313909_avatar" style="display:none">
            https://pic.cnblogs.com/face/733013/20180330130915.png
        </span>

                </div>
            </div>
        </div>
        <div class="feedbackItem">
            <div class="feedbackListSubtitle">
                <div class="feedbackManage">
                    &nbsp;&nbsp;
                    

<span class="comment_actions">
    
    
    
    
</span>


                </div>
                <!-- Title -->
                
<a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4329496" class="layer">#10楼</a>
<a name="4329496" id="comment_anchor_4329496"></a>


                <!-- PostDate -->
                
<span class="comment_date">2019-08-17 15:58</span>


                <!--NameLink-->
                

            <a id="a_comment_author_4329496" href="https://home.cnblogs.com/u/1771592/" target="_blank">随风奔跑2019</a>

                <div class="feedbackCon">
                    
<div id="comment_body_4329496" data-format-type="Ubb" class="blog_comment_body cnblogs-ubb">
    您好 咨询一个问题，事务提交后，只是 保障redo log落盘，而数据可能还未更新到磁盘，那事务提交后立刻查询，是不是可能查不到新提交的变化呢  ？这块是怎么处理的
</div>
        <div class="comment_vote">
            <span class="comment_error" style="color: red"></span>
            <a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(4329496, &#39;Digg&#39;, this.parentElement, false);">
                支持(0)
            </a>
            <a href="javascript:void(0);" class="comment_burry" onclick="return voteComment(4329496, &#39;Bury&#39;, this.parentElement, false);">
                反对(0)
            </a>
        </div>
        

                </div>
            </div>
        </div>
        <div class="feedbackItem">
            <div class="feedbackListSubtitle">
                <div class="feedbackManage">
                    &nbsp;&nbsp;
                    

<span class="comment_actions">
    
    
    
    
</span>


                </div>
                <!-- Title -->
                
<a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4329722" class="layer">#11楼</a>
<a name="4329722" id="comment_anchor_4329722"></a>
[<span class="louzhu">楼主</span>]

                <!-- PostDate -->
                
<span class="comment_date">2019-08-18 00:06</span>


                <!--NameLink-->
                

            <a id="a_comment_author_4329722" href="https://www.cnblogs.com/f-ck-need-u/" target="_blank">骏马金龙</a>

                <div class="feedbackCon">
                    
<div id="comment_body_4329722" data-format-type="Ubb" class="blog_comment_body cnblogs-ubb">
    <a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4329496" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,4329496);">@</a>
随风奔跑2019<br>缓存中有更新好的数据啊。<br>数据更新时：<br>在缓存中，是先写缓存数据、再写缓存redo log，这样对本事务来说能保持一致性(对其它事务来说，要看事务隔离级别)。<br>在刷到磁盘时，是先redo log再刷数据的，这样保证持久性和一致性。
</div>
        <div class="comment_vote">
            <span class="comment_error" style="color: red"></span>
            <a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(4329722, &#39;Digg&#39;, this.parentElement, false);">
                支持(0)
            </a>
            <a href="javascript:void(0);" class="comment_burry" onclick="return voteComment(4329722, &#39;Bury&#39;, this.parentElement, false);">
                反对(0)
            </a>
        </div>
        <span id="comment_4329722_avatar" style="display:none">
            https://pic.cnblogs.com/face/733013/20180330130915.png
        </span>

                </div>
            </div>
        </div>
        <div class="feedbackItem">
            <div class="feedbackListSubtitle">
                <div class="feedbackManage">
                    &nbsp;&nbsp;
                    

<span class="comment_actions">
    
    
    
    
</span>


                </div>
                <!-- Title -->
                
<a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4548183" class="layer">#12楼</a>
<a name="4548183" id="comment_anchor_4548183"></a>

        <span id="comment-maxId" style="display:none">4548183</span>
        <span id="comment-maxDate" style="display:none">2020/4/11 下午9:47:06</span>

                <!-- PostDate -->
                
<span class="comment_date">2020-04-11 21:47</span>


                <!--NameLink-->
                

            <a id="a_comment_author_4548183" href="https://home.cnblogs.com/u/2004590/" target="_blank">xiaoed</a>

                <div class="feedbackCon">
                    
<div id="comment_body_4548183" data-format-type="Markdown" class="blog_comment_body cnblogs-markdown">
    <p><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#4312799" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,4312799);">@</a>Web游离者</p>
<blockquote>
<p>@骏马金龙 楼主写的很详细，我也在看《MySQL技术内幕：InnoDB存储引擎》这本书，对于redo log这一块一直有一个疑问未能找到答案，希望能从你这边得到一些帮助。<br>
当一个事务启动后，会不断持续的往redo log中写入 log record，但是这个时候事务并未提交，如果这个时候出现 redo log 刷盘，那这部分未提交事务的 log record 也会保存到 redo log file 中，如果在这个时候MySQL服务宕机，重启MySQL时，怎么判断 redo log file 中的 log record 所属的事务是否已经提交呢？</p>
</blockquote>
<p>redo log是在什么时候刷盘的呢？参考innodb_flush_log_at_trx_commit的1、2、3的取值，只有在事务提交的时候会去刷盘，所以redo log成功刷盘，就可以断定事务一定是提交的。</p>

</div>
        <div class="comment_vote">
            <span class="comment_error" style="color: red"></span>
            <a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(4548183, &#39;Digg&#39;, this.parentElement, false);">
                支持(0)
            </a>
            <a href="javascript:void(0);" class="comment_burry" onclick="return voteComment(4548183, &#39;Bury&#39;, this.parentElement, false);">
                反对(0)
            </a>
        </div>
        

                </div>
            </div>
        </div>


<div id="comment_pager_bottom">
    
</div>
</div>
<script>
    var commentManager = new blogCommentManager();
    commentManager.renderComments(0);
</script>

<div id="comment_form" class="commentform">
    <a name="commentform"></a>
    <div id="divCommentShow"></div>
    <div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#" onclick="return RefreshPage();">刷新页面</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#top">返回顶部</a></div>
    <div id="comment_form_container" style="visibility: visible;"><div class="login_tips">
    注册用户登录后才能发表评论，请 
    <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return login(&#39;commentform&#39;);">登录</a>
     或 
    <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return register();">注册</a>，
    <a href="https://www.cnblogs.com/">访问</a> 网站首页。
</div></div>
    <div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
    <div id="ad_t2"><a href="http://www.ucancode.com/index.htm" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-ucancode&#39;)">【推荐】超50万行VC++源码: 大型组态工控、电力仿真CAD与GIS源码库</a><br><a href="https://cloud.tencent.com/act/seckill?fromSource=gwzcw.3498755.3498755.3498755&amp;utm_medium=cpc&amp;utm_id=gwzcw.3498755.3498755.3498755" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-腾讯云&#39;)">【推荐】腾讯云产品限时秒杀，爆款1核2G云服务器99元/年！</a><br></div>
    <div id="opt_under_post"></div>
    <script async="async" src="./详细分析MySQL事务日志(redo log和undo log)_files/gpt.js.下载"></script>
    <script>
        var googletag = googletag || {};
        googletag.cmd = googletag.cmd || [];
    </script>
    <script>
        googletag.cmd.push(function () {
            googletag.defineSlot("/1090369/C1", [300, 250], "div-gpt-ad-1546353474406-0").addService(googletag.pubads());
            googletag.defineSlot("/1090369/C2", [468, 60], "div-gpt-ad-1539008685004-0").addService(googletag.pubads());
            googletag.pubads().enableSingleRequest();
            googletag.enableServices();
        });
    </script>
    <div id="cnblogs_c1" class="c_ad_block" style="">
        <div id="div-gpt-ad-1546353474406-0" style="height: 250px; width: 300px;"><div id="google_ads_iframe_/1090369/C1_0__container__" style="border: 0pt none; width: 300px; height: 250px;"></div></div>
    </div>
    <div id="under_post_news"></div>
    <div id="cnblogs_c2" class="c_ad_block" style="">
        <div id="div-gpt-ad-1539008685004-0" style="height: 60px; width: 468px;">
            <script>
                if (new Date() >= new Date(2018, 9, 13)) {
                    googletag.cmd.push(function () { googletag.display("div-gpt-ad-1539008685004-0"); });
                }
            </script>
        <div id="google_ads_iframe_/1090369/C2_0__container__" style="border: 0pt none; width: 468px; height: 60px;"></div></div>
    </div>
    <div id="under_post_kb">
<div class="itnews c_ad_block">
    <b>最新 IT 新闻</b>:
    <br>
 ·              <a href="https://news.cnblogs.com/n/659646/" target="_blank">罗永浩直播带货的命门与受益者</a>
            <br>
 ·              <a href="https://news.cnblogs.com/n/659645/" target="_blank">为什么车厂能造呼吸机？</a>
            <br>
 ·              <a href="https://news.cnblogs.com/n/659644/" target="_blank">“5G疫情谣言”肆虐社交网络 英国1个月发生数十起基站袭击事件</a>
            <br>
 ·              <a href="https://news.cnblogs.com/n/659643/" target="_blank">疯狂的《动森》：游戏已下架，“黑产”依旧火</a>
            <br>
 ·              <a href="https://news.cnblogs.com/n/659642/" target="_blank">短视频借直播电商“造反”，抖音、快手挑战阿里胜算几何？</a>
            <br>
    » <a href="https://news.cnblogs.com/" title="IT 新闻" target="_blank">更多新闻...</a>
</div></div>
    <div id="HistoryToday" class="c_ad_block"></div>
    <script type="text/javascript">
        fixPostBody();
        deliverBigBanner();
setTimeout(function() { incrementViewCount(cb_entryId); }, 50);        deliverAdT2();
        deliverAdC1();
        deliverAdC2();
        loadNewsAndKb();
        loadBlogSignature();
LoadPostCategoriesTags(cb_blogId, cb_entryId);        LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
        GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
        loadOptUnderPost();
        GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);
    </script>
</div>    </div>
</div>
            </div>
        </div>

        <div id="sideBar">
            <div id="sideBarMain">
                
<div id="sidebar_news" class="newsItem">
<h3 class="catListTitle">公告</h3>

<div id="blog-news">
    <!-- 打赏相关 -->
<script type="text/javascript">window['__document_write_ajax_callbacks__']['4']();</script><script type="text/javascript">window['__document_write_ajax_callbacks__']['5']();</script><script type="text/javascript">window['__document_write_ajax_callbacks__']['1']();</script>
<script type="text/javascript">window['__document_write_ajax_callbacks__']['6']();</script><script>window['__document_write_ajax_callbacks__']['2']();</script>

<img src="./详细分析MySQL事务日志(redo log和undo log)_files/saved_resource" border="1"><br>
<a href="https://www.cnblogs.com/f-ck-need-u/p/9315728.html" target="_blank" style="font-size: 24px;color: red;">我为什么坚持写博客</a>
<p>&nbsp;</p>
<p><a href="https://www.cnblogs.com/f-ck-need-u/p/11785409.html" style="font-size: 24px;font-weight: bold;">视频教程汇总</a></p>
<p>&nbsp;</p>
<p><a href="https://blog.51cto.com/cloumn/detail/83" style="font-size: 24px;font-weight: bold;">Ansible专栏文章</a><br>
<img src="./详细分析MySQL事务日志(redo log和undo log)_files/ansible_zhuanlan.bmp" style=" width: 50%;"></p>
<p>&nbsp;</p>
<p><span style="font-size: 24px;"><strong>系列文章目录：</strong></span></p>
<p>
<a href="https://www.cnblogs.com/f-ck-need-u/p/7048359.html" target="_blank">1.Linux回炉复习系列</a><br>
<a href="https://www.cnblogs.com/f-ck-need-u/p/7576137.html" target="_blank">2.网站架构从LAMP开始</a><br>
<a href="https://www.cnblogs.com/f-ck-need-u/p/7586194.html" target="_blank">3.MySQL/MariaDB系列</a><br>
<a href="https://www.cnblogs.com/f-ck-need-u/p/9512185.html" target="_blank">4.Perl系列</a><br>
<a href="https://www.cnblogs.com/f-ck-need-u/p/9832640.html" target="_blank">5.Python系列</a><br>
<a href="https://www.cnblogs.com/f-ck-need-u/p/9832538.html" target="_blank">6.Golang系列</a><br>
<a href="https://www.cnblogs.com/f-ck-need-u/p/10805545.html" target="_blank">7.Ruby系列</a><br>
<a href="https://www.junmajinlong.com/os/index/" target="_blank">8.操作系统系列</a><br>
<a href="https://www.junmajinlong.com/shell/awk/index/" target="_blank">9.awk系列</a><br>
<a href="https://www.cnblogs.com/f-ck-need-u/category/1105323.html" target="_blank">10.JAVA学习笔记</a></p>

<p><span style="font-size: 24px;"><strong>本人作品下载(pdf)：</strong></span></p>
<p><a href="https://files.cnblogs.com/files/f-ck-need-u/linux.rar" target="_blank">1.Linux基础千锤百炼 v3</a><br>
<a href="https://download.csdn.net/download/a905815661/10295871" target="_blank">2.pacemaker入门指南(官方手册翻译)</a><br>
<a href="https://download.csdn.net/download/a905815661/10320937" target="_blank">3.玩透sed：探究sed原理</a><br>
<a href="https://files.cnblogs.com/files/f-ck-need-u/Ansible_book.rar" target="_blank">4.Ansible教程</a><br>
<a href="https://files.cnblogs.com/files/f-ck-need-u/master_Perl_one_liner.rar" target="_blank">5.Perl一行式详细教程</a><br>
<a href="https://files.cnblogs.com/files/f-ck-need-u/MySQL_GR.rar" target="_blank">6.MySQL组复制官方手册翻译</a><br>
<a href="https://files.cnblogs.com/files/f-ck-need-u/ProxySQL_cn.rar" target="_blank">7.ProxySQL官方手册翻译</a><br>
<a href="https://files.cnblogs.com/files/f-ck-need-u/awk_examples.zip" target="_blank">8.18个awk经典实战案例</a><br>
</p>
    <div id="profile_block">
        昵称：
        <a href="https://home.cnblogs.com/u/f-ck-need-u/">
            骏马金龙
        </a>
        <br>
        园龄：
        <a href="https://home.cnblogs.com/u/f-ck-need-u/" title="入园时间：2015-03-19">
            5年
        </a>
        <br>
        粉丝：
        <a href="https://home.cnblogs.com/u/f-ck-need-u/followers/">
            1621
        </a>
        <br>
        关注：
        <a href="https://home.cnblogs.com/u/f-ck-need-u/followees/">
            24
        </a>
        <div id="p_b_follow">
<a href="javascript:void(0)" onclick="follow(&#39;1e7fa90d-decd-e411-b908-9dcfd8948a71&#39;)">+加关注</a></div>
        <script type="text/javascript">window['__document_write_ajax_callbacks__']['7']();</script><script>window['__document_write_ajax_callbacks__']['3']();</script>
    </div>
</div></div>

                <div id="calendar"><div id="blog-calendar" style="display:none"></div></div>                
                <script>loadBlogDefaultCalendar();</script>
                <div id="leftcontentcontainer">
                    <!-- begin:SingleColumn -->
                    <div id="blog-sidecolumn">
<!-- 搜索 -->
<div id="sidebar_search" class="sidebar-block">
    <div id="sidebar_search" class="mySearch">
        <h3 class="catListTitle">搜索</h3>
        <div id="sidebar_search_box">
            <div id="widget_my_zzk" class="div_my_zzk">
                <input type="text" id="q" onkeydown="return zzk_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="zzk_go()" type="button" value="找找看" id="btnZzk" class="btn_my_zzk">
            </div>
            <div id="widget_my_google" class="div_my_zzk">
                <input type="text" name="google_q" id="google_q" onkeydown="return google_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="google_go()" type="button" value="谷歌搜索" class="btn_my_zzk">
            </div>
        </div>
    </div>
</div>

<!-- 常用链接 -->


<!-- 最新随笔 -->



<!-- 我的标签 -->


<!-- 积分与排名 -->
<div id="sidebar_scorerank" class="sidebar-block">
    
<div class="catListBlogRank">
    <h3 class="catListTitle">积分与排名</h3>
    <ul>
        <li class="liScore">
            积分 - 
860942
        </li>
        <li class="liRank">
            排名 - 
172
        </li>
    </ul>
</div>
</div>

<!-- 随笔分类、随笔档案、文章分类、新闻分类、相册、链接 -->
<div id="sidebar_categories">
    
        <div class="catListPostCategory">
            <h3 class="catListTitle">
                

随笔分类
<span style="font-size:11px;font-weight:normal">(662)</span>


            </h3>
            <ul>
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1598359.html" rel="" target="">
    Awk(1)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1427628.html" rel="" target="">
    C(1)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1255590.html" rel="" target="">
    Fighting on the way(2)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1325292.html" rel="" target="">
    Golang(44)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1105323.html" rel="" target="">
    java学习笔记(26)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/676536.html" rel="" target="">
    Linux 基础篇(63)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1017759.html" rel="" target="">
    Linux 杂项(80)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1030506.html" rel="" target="">
    Linux服务篇(36)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/912772.html" rel="" target="">
    OpenSSL(21)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1283128.html" rel="" target="">
    Perl语言(83)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1252812.html" rel="" target="">
    ProxySQL(15)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1228710.html" rel="" target="">
    python(46)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1442142.html" rel="" target="">
    Ruby(4)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1041099.html" rel="" target="">
    shell(50)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1242831.html" rel="" target="">
    ZooKeeper(7)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1412392.html" rel="" target="">
    操作系统(4)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1242602.html" rel="" target="">
    分布式(7)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1311970.html" rel="" target="">
    计算机语言通用知识(13)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1577326.html" rel="" target="">
    视频课程(1)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1085743.html" rel="" target="">
    数据库系列(98)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1085065.html" rel="" target="">
    网站架构(53)
</a>

                            

                        </li>
                        
                        <li>
                            
<a href="https://www.cnblogs.com/f-ck-need-u/category/1261523.html" rel="" target="">
    杂项(7)
</a>

                            

                        </li>
                        
            </ul>
        </div>

</div>

<!-- 最新评论 -->
<div id="sidebar_recentcomments" class="sidebar-block">
    <div id="recent_comments_wrap" class="RecentComment">
    <h3 class="catListTitle">最新评论</h3>
    <div class="RecentCommentBlock">
        <ul>
                    <li class="recent_comment_title"><a href="https://www.cnblogs.com/f-ck-need-u/p/9010872.html">1. Re:详细分析MySQL事务日志(redo log和undo log)</a></li>
                    <li class="recent_comment_body">@Web游离者 @骏马金龙 楼主写的很详细，我也在看《MySQL技术内幕：InnoDB存储引擎》这本书，对于redo log这一块一直有一个疑问未能找到答案，希望能从你这边得到一些帮助。 当一个事务启...</li>
                    <li class="recent_comment_author">--xiaoed</li>
                    <li class="recent_comment_title"><a href="https://www.cnblogs.com/f-ck-need-u/p/10035768.html">2. Re:Go标准库：深入剖析Go template</a></li>
                    <li class="recent_comment_body"><p>赞</p>
</li>
                    <li class="recent_comment_author">--IamFelix</li>
                    <li class="recent_comment_title"><a href="https://www.cnblogs.com/f-ck-need-u/p/7220009.html">3. Re:第2章 rsync(一)：基本命令和用法</a></li>
                    <li class="recent_comment_body"><p>感谢博主，太厉害了。。</p>
</li>
                    <li class="recent_comment_author">--东风龙飞</li>
                    <li class="recent_comment_title"><a href="https://www.cnblogs.com/f-ck-need-u/p/9490629.html">4. Re:应用负载均衡之LVS(五)：lvs和nginx的wrr加权调度算法规律分析</a></li>
                    <li class="recent_comment_body">改进的nginx的wrr算法并没有更趋于调度均衡 拿你最后的“两后端节点，它们的比例为3:1，它们的调度顺序将是aaba aaba aaba” 第一次的负载确实是更趋于调度均衡，但是后面的负载其实还是...</li>
                    <li class="recent_comment_author">--金枪语</li>
                    <li class="recent_comment_title"><a href="https://www.cnblogs.com/f-ck-need-u/p/7742153.html">5. Re:MySQL show processlist说明</a></li>
                    <li class="recent_comment_body"><p>老哥，转载您这篇文章，已注明出处。</p>
</li>
                    <li class="recent_comment_author">--锅巴少年</li>
        </ul>
    </div>
</div>
</div>



<!-- 阅读排行榜 -->
<div id="sidebar_topviewedposts" class="sidebar-block">
    
<div id="topview_posts_wrap">
    <h3 class="catListTitle">阅读排行榜</h3>
    <div id="TopViewPostsBlock">
        <ul style="word-break:break-all">
                    <li>
                        <a href="https://www.cnblogs.com/f-ck-need-u/p/7064286.html">
                            1. 抓包工具tcpdump用法说明(196493)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/f-ck-need-u/p/7220009.html">
                            2. 第2章 rsync(一)：基本命令和用法(106371)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/f-ck-need-u/p/7048359.html">
                            3. Linux和Shell回炉复习系列文章总目录(92551)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/f-ck-need-u/p/7231832.html">
                            4. SHELL脚本--expr命令全解(56595)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/f-ck-need-u/p/9010872.html">
                            5. 详细分析MySQL事务日志(redo log和undo log)(50156)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/f-ck-need-u/p/7430264.html">
                            6. Linux中文件MD5校验(39878)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/f-ck-need-u/p/5925923.html">
                            7. xargs原理剖析及用法详解(35767)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/f-ck-need-u/p/7571974.html">
                            8. Ansible系列(五)：各种变量定义方式和变量引用(34874)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/f-ck-need-u/p/7576137.html">
                            9. 网站架构从0起步系列文章总目录(32888)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/f-ck-need-u/p/5915076.html">
                            10. shell脚本--echo和printf打印输出(29593)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/f-ck-need-u/p/7094693.html">
                            11. grub2详解(翻译和整理官方手册)(27004)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/f-ck-need-u/p/7627035.html">
                            12. 简单说明CGI和动态请求是什么(25323)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/f-ck-need-u/p/7586194.html">
                            13. MySQL/MariaDB系列文章目录(25147)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/f-ck-need-u/p/6091027.html">
                            14. OpenSSL主配置文件openssl.cnf(23953)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/f-ck-need-u/p/9001061.html">
                            15. 详细分析MySQL的日志(一)(23914)
                        </a>
                    </li>
        </ul>
    </div>
</div>
</div>

<!-- 评论排行榜 -->
<div id="sidebar_topcommentedposts" class="sidebar-block">
    
<div id="topfeedback_posts_wrap">
    <h3 class="catListTitle">评论排行榜</h3>
    <div id="TopFeedbackPostsBlock">
        <ul style="word-break:break-all">
                    <li>
                        <a href="https://www.cnblogs.com/f-ck-need-u/p/9315728.html">
                            1. 写了300多篇文章了，说说我为什么坚持写博客(139)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/f-ck-need-u/p/7048359.html">
                            2. Linux和Shell回炉复习系列文章总目录(50)
                        </a>
                    </li>
        </ul>
    </div>
</div>
</div>

<!-- 推荐排行榜 -->
<div id="sidebar_topdiggedposts" class="sidebar-block">
    
<div id="topdigg_posts_wrap">
    <div class="catListView">
        <h3 class="catListTitle">推荐排行榜</h3>
        <div id="TopDiggPostsBlock">
            <ul style="word-break: break-all">
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/9315728.html">
                                1. 写了300多篇文章了，说说我为什么坚持写博客(227)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/7048359.html">
                                2. Linux和Shell回炉复习系列文章总目录(201)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/7576137.html">
                                3. 网站架构从0起步系列文章总目录(84)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/7220009.html">
                                4. 第2章 rsync(一)：基本命令和用法(48)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/6995195.html">
                                5. 第1章 Linux文件类基础命令(48)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/9010872.html">
                                6. 详细分析MySQL事务日志(redo log和undo log)(44)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/5925923.html">
                                7. xargs原理剖析及用法详解(42)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/7016077.html">
                                8. 第4章 ext文件系统机制原理剖析(35)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/7586194.html">
                                9. MySQL/MariaDB系列文章目录(34)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/7064286.html">
                                10. 抓包工具tcpdump用法说明(32)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/6995529.html">
                                11. Linux find运行机制详解(29)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/7624733.html">
                                12. 五种IO模型透彻分析(26)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/11141636.html">
                                13. 关于CPU的一些基本知识总结(26)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/7058920.html">
                                14. 第9章 Linux进程和信号超详细分析(26)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/7367503.html">
                                15. 第7章 DNS &amp; bind从基础到深入(25)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/7683027.html">
                                16. nginx作为web服务以及nginx.conf详解(25)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/9155003.html">
                                17. 深入MySQL复制(一)(25)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/7623252.html">
                                18. 不可不知的socket和TCP连接过程(24)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/7615914.html">
                                19. 零复制(zero copy)技术(21)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/f-ck-need-u/p/7397146.html">
                                20. 防火墙和iptables(21)
                            </a>
                        </li>
            </ul>
        </div>
    </div>
</div>
</div></div>
                    <script>loadBlogSideColumn();</script>
                    <!-- end:  SingleColumn -->
                </div>
            </div>
        <div id="div_digg">
    <div class="diggit" onclick="votePost(9010872,&#39;Digg&#39;)">
        <span class="diggnum" id="digg_count">44</span>
    </div>
    <div class="buryit" onclick="votePost(9010872,&#39;Bury&#39;)">
        <span class="burynum" id="bury_count">0</span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div></div>
        <div class="clear"></div>
    </div>
    <div class="clear"></div>
    <div id="footer">
        <!--done-->
Copyright © 2020 骏马金龙
<br><span id="poweredby">Powered by .NET Core on Kubernetes</span>

    </div>
</div>

    <div id="page_end_html">
        <script type="text/javascript" src="./详细分析MySQL事务日志(redo log和undo log)_files/lnh.cnblogs1.js.下载"></script>
<script src="./详细分析MySQL事务日志(redo log和undo log)_files/highlightjs-line-numbers.min.js.下载"></script>
<script>hljs.initLineNumbersOnLoad();</script>

<!-- icon相关 -->
<script type="text/javascript" language="javascript">
　　var linkObject = document.createElement('link');
　　linkObject.rel = "shortcut icon";
　　linkObject.href = "https://files.cnblogs.com/files/f-ck-need-u/favicon.ico";
　　document.getElementsByTagName("head")[0].appendChild(linkObject);
</script>


<script>
//var myref='<a href="'+document.location.href+'">'+document.location.href+'</a>';
var ref = document.location.protocol + "//" + document.location.hostname + document.location.pathname;
var myref = '<a href="' + ref + '">' + ref + '</a>';
var zhuanzai='<strong><span style="font-size: 18px;">转载请注明出处：'+myref+'</span></strong>';
var tuijian='<strong><span style="font-size: 18px;">如果觉得文章不错，不妨给个<font color="#0000ff" size="6">打赏</font>，写作不易，各位的支持，能激发和鼓励我更大的写作热情。谢谢！</span></strong>';
// var gif='<img src="https://files.cnblogs.com/files/f-ck-need-u/a.gif">';
var wealipay='<img src="https://files.cnblogs.com/files/f-ck-need-u/wealipay.bmp">';

//var zhuanzai='<strong><span style="font-size: 18px;">转载请务必在文章<span style="color: red;">最开头</span>标明原文地址<br>本文原创地址：骏马金龙' + myref + '</span></strong><br/>';
//var zhuanzai='<strong><span style="font-size: 18px;color: red">Shell技术交流群：921383787</span></strong><br/>';
var banjia='<strong><span style="font-size: 18px;">本人博客搬家：骏马金龙<a href="https://www.junmajinlong.com">www.junmajinlong.com</a></span></strong>';
//$("#cnblogs_post_body").prepend("<p>"+banjia+"</p><p>&nbsp;</p>");
//$("#cnblogs_post_body").prepend("<p>"+zhuanzai+"</p><p>&nbsp;</p>");
$("#cnblogs_post_body").append("<p>&nbsp;</p><p>"+zhuanzai+"</p>");
$("#cnblogs_post_body").append("<p>"+tuijian+"<br />");
$("#cnblogs_post_body").append(wealipay+"</p>");
// $("#cnblogs_post_body").append(gif+"</p>");
$("#cnblogs_post_body").append("</p>");
</script>

<div id="sideBar">
        <div class="follow">
            <a href="javascript:follow();" style="font-weight: bold; padding-left: 5px"><font color="#ff0000">😀点这里关注我😀</font></a><br>
            <a href="https://jq.qq.com/?_wv=1027&amp;k=5fqQBsX" target="_blank" style="font-weight: bold; padding-left: 5px"><font color="#0000ff">QQ群921383787</font></a><br>
            <a href="javascript:lnh.toc.toggle();" style="font-weight: bold; padding-left: 5px"><font color="#0000ff">缩/放目录</font></a>
    </div>
</div>
    </div><div class="fixed-bar-warp"><div class="fixed-bar"><a class="item toc" href="javascript:lnh.toc.toggle();" title="目录"><i class="fa fa-hashtag"></i></a><a class="item comments" href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#comment_form_container" title="评论列表"><i class="fa fa-comments"></i></a><a class="item comment" href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#comment_form" title="写评论"><i class="fa fa-pencil"></i></a><a class="item top" href="javascript:scroll(0,0);" title="返回顶部"><i class="fa fa-arrow-circle-up"></i></a></div></div><div id="table_of_content_warp" class="lnh_toc_warp" style="display: inline-block;"><div class="title"># 本文目录：<br><span style="font-size: 10px;">(右下角 # 关闭目录)</span></div><div class="toc"><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_0" id="toc_auto_id_0" class="item item-h1" title="1.redo log">1.redo log</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_1" id="toc_auto_id_1" class="item item-h2" title="1.1 redo log和二进制日志的区别">1.1 redo log和二进制日志的区别</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_2" id="toc_auto_id_2" class="item item-h2 current" title="1.2 redo log的基本概念">1.2 redo log的基本概念</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_3" id="toc_auto_id_3" class="item item-h2" title="1.3 日志块(log block)">1.3 日志块(log block)</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_4" id="toc_auto_id_4" class="item item-h2" title="1.4 log group和redo log file">1.4 log group和redo log file</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_5" id="toc_auto_id_5" class="item item-h2" title="1.5 redo log的格式">1.5 redo log的格式</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_6" id="toc_auto_id_6" class="item item-h2" title="1.6 日志刷盘的规则">1.6 日志刷盘的规则</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_7" id="toc_auto_id_7" class="item item-h2" title="1.7 数据页刷盘的规则及checkpoint">1.7 数据页刷盘的规则及checkpoint</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_8" id="toc_auto_id_8" class="item item-h2" title="1.8 LSN超详细分析">1.8 LSN超详细分析</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_9" id="toc_auto_id_9" class="item item-h2" title="1.9 innodb的恢复行为">1.9 innodb的恢复行为</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_10" id="toc_auto_id_10" class="item item-h2" title="1.10 和redo log有关的几个变量">1.10 和redo log有关的几个变量</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_11" id="toc_auto_id_11" class="item item-h1" title="2.undo log">2.undo log</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_12" id="toc_auto_id_12" class="item item-h2" title="2.1 基本概念">2.1 基本概念</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_13" id="toc_auto_id_13" class="item item-h2" title="2.2 undo log的存储方式">2.2 undo log的存储方式</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_14" id="toc_auto_id_14" class="item item-h2" title="2.3 和undo log相关的变量">2.3 和undo log相关的变量</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_15" id="toc_auto_id_15" class="item item-h2" title="2.4 delete/update操作的内部机制">2.4 delete/update操作的内部机制</a><a href="https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_16" id="toc_auto_id_16" class="item item-h1" title="3.binlog和事务日志的先后顺序及group commit">3.binlog和事务日志的先后顺序及group commit</a></div></div>

<script type="text/javascript">
  new tctip({
    top: '20%',
    button: {
      id: 9,
      type: 'dashang',
    },
    list: [
      {
        type: 'alipay',
        qrImg: 'https://files.cnblogs.com/files/f-ck-need-u/alipay.bmp'
      }, {
        type: 'wechat',
        qrImg: 'https://files.cnblogs.com/files/f-ck-need-u/wepay.bmp'
      }
    ]
  }).init()
</script><div class="tctip" style="top: 20%;"><a class="tctip-btn-box" href="javascript:;"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAABdCAYAAADAM7TWAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpCODE5MjMyNEYyOEJFNDExOTlCNkY0REE0Mjk1RUE2MSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2RThFQzBCNjhDRjQxMUU0QjU4MThFMEJGNDM2OEE2NCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2RThFQzBCNThDRjQxMUU0QjU4MThFMEJGNDM2OEE2NCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkE3MzAxMjMwRkE4QkU0MTE5OUI2RjREQTQyOTVFQTYxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkI4MTkyMzI0RjI4QkU0MTE5OUI2RjREQTQyOTVFQTYxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+LrQk8wAABP5JREFUeNrsm89vE0cUx59/ZW2wA3Hs2KlDogSoUKMIqGhTlf6QeqiqVqByQdy491Rx4B/opYo49dA7lx64oUoVh6qHVKhAWyht06gyhAIxCXa8JHXAjo2dznfwWBP/2B+212uVfdJoHcfe+eyb73vz3kRxnZpfo3qbG30SZJcv2DjFRoINL1ls3iYQX7LLubVC2Zd6WqZMoUz58jZVtnsEwgAG2GV+s1SZva2WiIFQL032yHy2UJm9ltmi51Y/fhNzV71xAZ64bhMEB6kK8/Nb2SKVbIIQHpljgvSoWxWy0wByAtFhtwEk3usIaQXiRZ7oBxCq2M/xAqQfzAFxQBwQB8QB+d+CmG4Tjk+OkOL10G+pLKnPivaBHBjZQ5FggB7n8vaCNLOAz0NTwyFayuZ0PxsOKLR31wAtrK53HwQQH02Pm/oOoPOlcndBCuyGa5v5hvdD/gGup2a/kyEMgUzH91IsFKj9jBvDXmVaEe9vPS/TxevJhu+enT1ICtPTL/czDUthWiOY7Oh4tHE5ontqr/HEV++lrRUrwhQRIuzYRJRHzbWlVVrPF2tLY3nUIETlMAUIDBB67n45MqtsicFddHgsTBvMO5ZrpGWq3x/n4Qm79SBjvUfCLAtOhkMUGwzQ2FCwNjlscUWlvx9v0F0DGbVjkA8PjVFiKMhf5wpFnjOQS67eXe2qWHVBHj7Z5Nc/Hql8YpGkei5WLsIOhehUaC9HQkPxgyF235V/n+mGvRzqXQHZzwqfT49M1n5GCLcqEz84OEr7wkG+MQrTgzYMgoSFyfmWz3ZihHIrQ7o/WoVAefBnSjVU2xpemm9+Thq64a/LWSowaHjBTHFtGMTMTdvJuG1FDYTYTBsYPdl9ETWnX5/i0SAvFd4X5eRP/6R3FMZn2OflLaIrHsEED9VNHsInZiZ2vN+sUke0YcNUGKhez2N6aX5IrtBSZoOHJyp8LXuDlZWItu8XUw3tQ725ksnk9uX72nH+8WtjFA3t3HHhFRHSrXoYwOIzKB+EZVj4f/fXcnsaAQRuKk8iQ4hapd759csV0SgfTInVSKOkJfTP3pvuXs0KAb5zIG7qO3fSG3STJbqOwxc3QrQgW46yyh0uFmWjlkEz0A6+C7FeWXjQshkzBCK3CgARcIggLUOCk9tVrWVtu50YYQLWy6QjoYA1mVU+gkCSwnavZ/is3hK2BfKI6eTSzSV7W04c5L01FW9rInSDWpoyBSKOIVKs10nn8oa1JBq0rve+gJCfDrllgukF5yj1kQFBGwHpShUfH3xxqiTOTixvJ/zVCr7e9lWfGLlFHFckqvnGErHeU3NUYNlRrsqxM8P14hwNe8onM+M8o0JLKIi+nl/QLQNMgcjHWIig6VfCfEJRc9QyKJscvwMghgDqOLOK83e+DOFgrfaAoUi6srhce2Jc4RkMFE4zEhBe/3hnlVJN+hzDHpH3DGx4ALi9rDa9qby3YAAIJ0yRUIf1CJ4OHkB4rrOlSRno3OqBULNCP63aEsMe0dtpjRTeWoJ1jiUcEAfEAXFAHJBegGx73a6+ACn5Pf0Bkh5W3H0B8m1it6cvQM5H/Z5y2GavuM+vDOFvZV8dGR4gn42i5W5gMOdCPveNN6MK2RVB8nq8G/G7f38/rlDE77EPhHmlyMbhoM994XhMKb0dU2gi6KXdXhf1wkkujf+dmGPjJBsx6sH/TvwnwAD/lU0rvEJ+QAAAAABJRU5ErkJggg=="></a><div class="tctip-main-box"><p class="tctip-title">感谢您的支持</p><div class="tctip-body-box"><div class="tctip-icon-box"><ul class="not-full"><li class="tctip-current"><a class="" href="javascript:">支付宝<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAeJSURBVHjarJZ5bBzVHcc/b+bN3pv1eteOj9gkxJRcIiUiKnUJRyUiUAMNTRuqIipFokWoaSkU1Oufilb8VVF6SCQUQQOlEVdJawSiDUVpMSRuHEKMmrOuE8d2fK3tXe81M++9/mHvYjuGItGvNHqamffe93f/fsIYwyw2lEql+3zfvxZICiEAWLhWUDn3MddJx3E6I5HIL4GDAMIYg1Lqzqmpqad938eyLIQQ857/RfxRD4DWGgDHcUgmk3dLKR8XWuu1mUzmfd/3CQQCVQLLsqqEC0nFzI/q5VrrjySurL7vI6UknU5fJQuFwk9d1yUYDLIQcwmFEFXJY/H4vH0TExMshsqZCrGUEtd1yefzPxfj4+Ojvu+npZTzNF1o8spB27LY9dsn6enpwRhYtXoVO+/5Jq5bxvP8izSuCFuB1hop5bQYGRkpCSGCc0k+zM+RSBghYOP1t3H4wEFA0b75Bjpff55isUipVL7I/HPjYA6KEvCAoDGmSqC0pjaZ5MOwZu1axvIGXylWr14NCMLhCOFw5KK9Y2NjuK670G2+nBHIzPvhSMnRd48yPjaCEwwhECAgEHCwgMnJKQLSQlqQGc/QdeggpXIZ1/XBGAwGpdSMkGvWEI1GcV13vv+Hh4ezQLxiYiltEokadtz9XZ7Z+yItLS0YDBiB0j5CWNQ3LScYjoCBUnGa0aFzCMCy7WpQFQpFAo7NH5/dzZXr1zE8MjZX45wYGhrKCiGqxJYlsG3JaGaK6UKZSCiImb3MkRKE4fs/eYQjPSfRWvPZq67g4R9/B9fz8H01IyTg+wqtFalElIDj4M9aoEIsK84Xs3mpNSjl0dJYRzAUXtTH4YBNoVhGK0UkKLmkpXHRfYV8jmwuj+t51Wypkg8ODs4zdSWKk8kku5/4HY/teoLGllYwIARYQnD87DjTJYUxhnhY8qmWWqS0aWqoA2PIZCZY2XYpP7h/J0oZXM9dmN85OTfMtdZV4nK5THNzM9dcewPp+jqgkpOCL29fQSwaBSCby3G+/zye7/PUH/aRnS5QGBji9h3bSaVqGRwaXphKMzWhkuAf5LAAI5icnGLLlpv44pab+Djo7e3lhY43aVnRxmB6KdtuvRmEwPf9RffP0xij0Uh0ogHhwNjoCHZ+CIwLdgQdbUJFkhgJwgeKeSjnaGxsYNdTexnNTBCOxmhM17Bu1Qqyk5OLajtLrDEGBAqCtZiaGiKnXyL0zqPYZ9/Cys92hSDoujRq2dXo+vV49ZvwUleypLGBo+dK/PlvR2hd1sTA4AXu/vptrF7VRl9fPwv6y1xiMEaj7BiBRA31HV/D69iLVwvFulWoVB2mmMXKDRA4PUa46xVs+QrBZlCXLCO6cStnDgfIZIvkQstJpBJ8ZevNlAt5jNawIJrnmVprg0jXk3ztTk49v5fIt/Zhr74B7UQwgHELmOlxzOhp7L63CfbuJ9zbSWzgPPr0b/hCArruTPJ090liV9zBylWX0zcNViyEXRxFqNJMSjCnbPb29mY9JxFvNad4+f528tv+xJe+egvZgWFQHsKyEJZE2BJtObgiiJcbI3S+i7ozHQS6nyQYBWJAFIg4TIeuJF+/mXLTjZTrPo2KLEH4Grs0juXlEDBTQKLRGCf//g77Ctfzo02bKfWfRXtqTk8uz4ppIYUgFHBo2bSVRwdiPPd2D/evm6BdnaE2CDrpYdtdpE51oRM/o5zeQLHuWspLr8NNr8eNX4qwZ00dEmVGRRPHR3yc6X5iS1NMj4xWC8oHrc0nmawhna5jz549PPzQr5gMt7H9cBvPfe9etka7cN94BqcE+RRYAoK5I0T7jqCDj1Je0kQpdTVuw0bEiRMnstJx4lFHcN2tO1i39nJe+v1u8tM5MhMTKKWR0iYej7EkFmVgYIBf/Ho3jz/bgYymiUbC/PDeHWy743YGz4+ie/ZRe+IF0n1/xSmAFweTABkCxwLpgzbkxLFjx7LK9+PNzQ3845//Ytvt3+D69nU88O27WLq0nkAgQD5fYGh4mMOHj/KXAwfpPtZLqLaB9o1XcN9d2/l8+3rO9g9QKJYoB5O4bpnwuU6Sva+S6nuVyKSHHwZVA3YI7BA50d3dndNax5TSXLaylUPvnWHngw/R29NDsqGWVHIJ+WKZkbFJ1OQ0dkMrm9o/w43XbGD7LdeRSkQ5859+jJjpapZlYbSmKJdQ0hbh4feo/XcHqd6XiY1MoGzwEuTEoUOHikqpkDGgtWJFazOesXntzS46u95lZDSDdCSJRIJljfVctryJDevaWNnawMDgBTKTORxHLpzysCwbIQRuoIayEyeYOUNt3+ukTr9IfOB4UXR2do57nldbCSLP94mEAixrakBjUSiWUUph2xaRUABLwIWRMbK5PFLKi0bfxadNUMEaypEGnPwF6s6+XhAHDhzo8Dxvy9yaWh1ljcGyLazZd6VNdRj8sBr8kQIYjXYikGh+S+zfv3+DUqrb9/2PJf0nhW3b2Lb9OWmMOWKMuUcp9VhlQFs4/H0SzL1rZrSyHjDGvC1nP+7SWr+vlHrQGLPRGBP7f2ophCgIIbqBR4wxbwgh+O8ATH/iUkiU/EcAAAAASUVORK5CYII=" alt="支付宝"></a></li><li class=""><a class="" href="javascript:">微信<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAVFSURBVEhLtVZrTJNXGH7BC0oLxhjMfsxE4xJ3z24xcf7YssmPZWZuxphtWba/259ll8zM6EJMxA0dZsoMm5q5LVkWF10krlIKRe6XcmuFCuMu0KICgoAUpPDsOd93OmopKM49zfP2nPN953m+876n56vMgteyRZqsDvEmTEhjAvh9f7ys6U3oleaEVKm1JmmHCFQlrpfmRJu08Oa/9eSGB0Bl3kY2W/qlPuEL7aZRH7deGq2t4ks0b4wm8F+pFtRD/UuWg9qVcFtzjcF6XpyTVtKiGe36PVCVrt3w2SrisbxqpFY91aVI0sQdC6kTk5449peE9ZdGmXMXdqhVW7OFnTzjSTwRrIsxTJ5p3oxd/r04deM3ZN204czQOWT0/4Cdne9jZcMaSK16gGUUo2CkRjSqveNJuCZSZx0XNzv/kimtETzV+ALODp7D5PQk5kL7eCc+69mNxXXMTN1izqX5HVpzMshUs1EXxmrBtradGJgc1PJ3R9aQDYnu1XxgVQaah+tFozKXWoYQq2KwqekVBKYCWhLoHb+qW3ciEAygb2JA94A/B89jUc1y6sTP6M1HqWFQrF6OJdWJqByp1lLAcf9PSCpKwpGeTD1iIjgdxHbvu1hd9jDqR716FPig40OIizUPac5HqWZQrIzBlqY3tISJY70/IrYsDt/6juoRE8r4tabtWOFaZdQ5BMdQPqSCxq5F1GTdQ9rRKFUMiuWCr7r3a4kZdN32YZqfSEzx0z3hQ+GNEnzffRzpVzJwqOsIXrycjNV1a7kQbjb1EFXcrCGPcIqLwcWLpYLDvgwte3d4hhuQ2n4Qx3tOoXbEjasT1zEavGVko29yAGcGziH58uuQMppXsvYubjrDS1MqaKpYLPiyI0XLzo+CG0XY07oPrWPteiQ6VJ7SfIeZTR48FfytV9Aw5CflDIolMdjsTjZnzIPWW23Y3ZKC4eCI0W+71YGW0TajHYI/0IuG4ZlNl9pziPpceTnrHvKTMgaDyxFbuAw5/U59e3Skdx6Fe8RjtKenp/FI+dNYU7IB48FxY0zhTc/bkNyl6An4jf4U79vofplZ5fEb8pNShhCLYvF4+XO4Pt5vTIjENdYxreOw7pnI9J/AUV8mxaf0CHC2LwspnQcwFhzTI8B3PccgBVx1KVetvKSEIZz5gk2VLzGFs+vnHr6EzK4Turcw2AfyIMyoFHOjKR8pYghnMZ/IITjl+1VPmYFv3I+T3T/r3sJwoS+HK+YmK6Kx8pFChnBeXMITaR1uTt6EZ6geO2vew46ad7C/OQ37mg/gI+8nWmph+LojnXVnqkM+UsAQzvzFeLJiI1KaUpGYy4M/hzczA5JtMt65Ck0jLVru3jDGc/2x0uchTp5oIR+5yBBJJ2mnkZMv+juumWVIdm3FRPC2lp0faud/7N1l6oVrST7DLNLA4BzXuPKtlW+hc/SKlp8b6W0ZEJtaBN9a4TpGUCtcEE3zh3LXYq83BeX9legL9Bu/5aGJIdQOuvF712mjfbL7F529sPm51klh8OsOJG+BzOGL/y9BjM2KNXkb8Gj+s1jnfAJx2SshWfwXU7ARexr3weJMoj53s5qj6ptn9dHY8o2xvZWxY4FUc4x5FLVz42TzZFLfDv5e1bjq2xYhxsEXRGhOGc9ru8UmcoH/8B3xw8YWDxd9YFQbUrfViktpnGPdYf6vtls+l3IOGOn7n6iM1evQbj0tKRJrGivYLWlSyAslpEqT/QFRGaq6qoXZrTbJXblCO4Yh27pN8iznebOf7alZIvfD7PgRLqRKciyfyh+y1DQS+Qc7LndRdtdxOQAAAABJRU5ErkJggg==" alt="微信"></a></li></ul></div><div class="tctip-qr-detail"><div class="tctip-qr-box"><p class="tctip-qr-title">扫描二维码打赏</p><div class="tctip-qr-code"><img src="./详细分析MySQL事务日志(redo log和undo log)_files/alipay.bmp"></div><p class="tctip-qr-desc">支付宝打赏</p></div></div></div><p class="tctip-footer"><a href="https://github.com/greedying/tctip" target="_blank">了解更多</a></p></div></div><script src="./详细分析MySQL事务日志(redo log和undo log)_files/1.0.3"></script><script type="text/javascript">getFollowStatus('1e7fa90d-decd-e411-b908-9dcfd8948a71');</script></body></html>